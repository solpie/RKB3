!function(e){function t(a){if(n[a])return n[a].exports;var r=n[a]={exports:{},id:a,loaded:!1};return e[a].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";n(!function(){var e=new Error('Cannot find module "../../../resources/app/static/css/bulma.min.css"');throw e.code="MODULE_NOT_FOUND",e}()),n(!function(){var e=new Error('Cannot find module "script!./../../../clientLibs/jquery.min.js"');throw e.code="MODULE_NOT_FOUND",e}()),n(!function(){var e=new Error('Cannot find module "script!./../../../clientLibs/qrcode.min.js"');throw e.code="MODULE_NOT_FOUND",e}()),n(!function(){var e=new Error('Cannot find module "script!./../../../clientLibs/vue/vue.min.js"');throw e.code="MODULE_NOT_FOUND",e}()),n(!function(){var e=new Error('Cannot find module "script!./../../../clientLibs/vue/vue-router.min.js"');throw e.code="MODULE_NOT_FOUND",e}());var a=n(1),r=n(3),i=n(6),o=n(12),s=n(19),l=[{path:"/",name:"home",components:{content:r.homeView,Navbar:a.Navbar}},{path:"/player",name:"player",components:{content:i.PlayerView,Navbar:a.Navbar}},{path:"/panel",name:"panel",components:{content:s.PanelView,Navbar:a.Navbar}},{path:"/rank",name:"rank",components:{content:o.RankView,Navbar:a.Navbar}}],c=new VueRouter({routes:l});c.afterEach(function(e,t){var n=e.path;c.app.active=n.split("/")[1]});new Vue({router:c}).$mount("#app")},function(e,t,n){"use strict";t.Navbar={props:{active:{}},template:n(2),methods:{}}},function(e,t){e.exports='<nav class="nav has-shadow" >\r\n    <div class="container">\r\n        <div class="nav-left">\r\n            <a class="nav-item" :class="{active: active === \'\'}">\r\n                <i class="home icon"></i>\r\n                <router-link :to="{ name: \'home\'}">Home</router-link>\r\n            </a>\r\n            <a class="nav-item" :class="{active: active === \'player\'}">\r\n                <i class="grid layout icon"></i>\r\n                <router-link :to="{ name: \'player\'}">玩家管理</router-link>\r\n            </a>\r\n            <a class="nav-item" :class="{active: active === \'panel\'}">\r\n                <router-link :to="{ name: \'panel\'}">比赛管理</router-link>\r\n            </a>\r\n            <a class="nav-item" :class="{active: active === \'rank\'}">\r\n                <router-link :to="{ name: \'rank\'}">天梯排名</router-link>\r\n            </a>\r\n        </div>\r\n\r\n        <div class="nav-right">\r\n            <a class="nav-item" :class="{active: active === \'setting\'}">\r\n                <router-link :to="{ name: \'setting\'}">setting</router-link>\r\n            </a>\r\n        </div>\r\n    </div>\r\n\r\n\r\n</nav>\r\n'},function(e,t,n){"use strict";var a=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=n(4),i=function(e){function t(){e.call(this),this.template=n(5),this.links=r.VueBase.PROP,this.opUrlArr=r.VueBase.PROP,this.selected=r.VueBase.PROP,this.options=r.VueBase.PROP,this.gameDataArr=r.VueBase.PROP,this.iosParam=r.VueBase.Dict,this.rmtpUrl=r.VueBase.String,this.watch={selected:"onSelGameID"},this.methods={onSelGameID:function(e){this.updateLinks(e),$.get("http://"+window.location.host+"/admin/sync/"+this.selected,function(e){console.log(e)})},onClkQRCode:function(){this.genQRCode()}},r.VueBase.initProps(this)}return a(t,e),t.prototype.created=function(){var e=this;console.log("post /admin/");var t="http://api.liangle.com/api/passerbyking/game/list";$.get("http://"+window.location.host+"/get?url="+t,function(t){var n=JSON.parse(t.entity);console.log(n);var a=n.data;e.gameDataArr=[];for(var r=0;r<a.length;r++){var i=a[a.length-1-r];i.text="["+i.id+"]:"+i.title,i.value=i.id,e.gameDataArr.push(i)}e.options=a})},t.prototype.mounted=function(){this.updateLinks(78)},t.prototype.updateLinks=function(e){this.links=[{title:"战团排行",url:"/panel/#/ol/auto/"+e+"?score=0"},{title:"八强对阵",url:"/panel/#!/bracket/auto/"+e},{title:"比分面板",url:"/panel/#/rkb/ob/"+e},{title:"比分面板 操作",url:"/panel/#/rkb/op/"+e},{title:"战团排行 操作",url:"/panel/#/ol/op/"+e},{title:"screen1v1 ob",url:"/panel/#/screen1v1/ob"}]},t.prototype.genQRCode=function(){this.iosParam={rtmp:this.rmtpUrl,gameId:this.selected+""},new QRCode(document.getElementById("qrcode"),{text:JSON.stringify(this.iosParam),width:256,height:256,colorDark:"#000000",colorLight:"#ffffff",correctLevel:QRCode.CorrectLevel.H})},t}(r.VueBase);t.homeView=new i},function(e,t){"use strict";var n=function(){function e(){this.props={},this.methods={}}return e.initProps=function(e){for(var t in e){var n=e[t];if(n.hasOwnProperty("_"))n.hasOwnProperty("v")?e.props[t]=n.v:n.hasOwnProperty("f")&&(e.methods[t]=n.f);else{var a=n instanceof Function;a&&(e.methods[t]=n)}}},e.prototype.created=function(){},e.prototype.mounted=function(){},e.PROP={v:null,_:null},e.Dict={v:{},_:null},e.Number={v:0,_:null},e.String={v:"",_:null},e}();t.VueBase=n},function(e,t){e.exports='<div class="container">\r\n    <nav class="panel">\r\n        <p class="panel-heading">\r\n            直播面板op入口 Game ID: {{ selected }}\r\n            <span class="select">\r\n                <select v-model="selected">\r\n                    <option v-for="option in options" v-bind:value="option.value">\r\n                        {{ option.text }}\r\n                    </option>\r\n                </select>\r\n            </span>\r\n        </p>\r\n        <vue v-for="link in links">\r\n            <a class="panel-block" :href="link.url" target="_blank">\r\n                <span class="panel-icon">\r\n            <i class="fa fa-book"></i>\r\n            </span> {{link.url}}\r\n                <br>\r\n                {{link.title}}\r\n            </a>\r\n        </vue>\r\n    </nav>\r\n    推流地址:<input type="text" v-model="rmtpUrl" style="width: 1000px">\r\n    <p>\r\n    <button class="button is-primary" @click="onClkQRCode">生成IOS二维码</button>\r\n    {{iosParam | json}}\r\n    <div id="qrcode"></div>\r\n</div>\r\n'},function(e,t,n){"use strict";var a=n(7),r=n(10),i=n(8),o=n(!function(){var e=new Error('Cannot find module "jquery"');throw e.code="MODULE_NOT_FOUND",e}());t.PlayerView={template:n(11),components:{Profile:a.Profile},props:["total","ftId","playerArr","playerMap","ftOptionArr"],mounted:function(){var e=this;console.log("player Ready!!"),this.$http.post("/db/player",{all:!0}).then(function(t){console.log(t),e.playerArr=t.body.PlayerArr})},methods:{onClearActPlayerGameRec:function(){this.post("/panel/stage1v1/"+r.CommandId.cs_clearActPlayerGameRec)},onSaveToTotalScore:function(){this.post("/panel/stage1v1/"+r.CommandId.cs_saveToTotalScore)},onPickPlayer:function(e){this.pickPlayerIdArr.push(e),4==this.pickPlayerIdArr.length&&(console.log("pick team"),this.pickPlayerIdArrArr.push(this.pickPlayerIdArr),this.pickPlayerIdArr=[]),this.total=4*this.pickPlayerIdArrArr.length+this.pickPlayerIdArr.length},onAddPlayer:function(){o("#modal-player").openModal(),this.message="添加球员",this.isOpen=!0,this.$broadcast(i.ViewEvent.PLAYER_ADD,{ftOptionArr:this.ftOptionArr.concat()})},onAddPlayerList:function(){for(var e=[],t=0;t<this.pickPlayerIdArrArr.length;t++){var n=this.pickPlayerIdArrArr[t];e=e.concat(n)}e=e.concat(this.pickPlayerIdArr),console.log("playerList",e),this.post("/panel/stage1v1/"+r.CommandId.cs_setActPlayer,{playerIdArr:e})},onEdit:function(e,t){t.stopPropagation(),console.log("onEdit",e),o("#modal-player").openModal(),this.message="编辑球员",this.$broadcast(i.ViewEvent.PLAYER_EDIT,{playerId:e,ftOptionArr:this.ftOptionArr.concat()})},onFtSelected:function(){this.playerArr=[];for(var e in this.playerMap){var t=this.playerMap[e];t.ftId==this.ftId&&this.playerArr.push(t)}}}}},function(e,t,n){"use strict";var a=n(8),r=t.Profile,i=n(!function(){var e=new Error('Cannot find module "jquery"');throw e.code="MODULE_NOT_FOUND",e}());t.Profile={template:n(9),props:{name:{type:String,required:!0},intro:{type:String,required:!0},weight:{type:String,required:!0},ftId:{},ftScore:{},curFtScore:{},location:{},ftOptionArr:{type:Array,required:!0,default:[]},height:{type:String,required:!0}},watch:{name:"onName"},methods:{setProp:function(e,t){t.name=e.name,t.weight=e.weight,t.height=e.height,t.intro=e.intro,t.ftId=e.ftId,t.location=e.location,t.curFtScore=e.curFtScore,t.ftScore=e.ftScore},onName:function(e){console.log("on name change",e)},onDeletePlayer:function(){console.log("onDeletePlayer"),this.post("/admin/player/delete",{id:this.editPlayerId},function(e){"OK"==e?(console.log("delete sus"),window.location.reload()):console.error("delete failed")})},onSubmitInfo:function(e){var t=this;e.stopPropagation(),console.log("onSubmitInfo"),i(".cropper-container").hide();var n={};if(this.setProp(this,n),this.isEdit){var a=function(){t.post("/admin/player/update",{playerDoc:n},function(e){console.log(e),t.isEdit=!1,e&&window.location.reload()})};n.id=this.editPlayerId,this.isChangeAvatar?(n.avatar=this.cropper.getCroppedCanvas().toDataURL(),a(),console.log("isChangeAvatar")):a()}else this.isChangeAvatar&&(n.avatar=this.cropper.getCroppedCanvas().toDataURL()),this.$http.post("/admin/player/add",{playerData:n},function(e){console.log(e),e&&window.location.reload()})},showFile:function(e){var t=this,n=new FileReader,a=document.getElementById("image");console.log("showFile",e.target.files[0]),n.readAsDataURL(e.target.files[0]),n.onload=function(e){t.isChangeAvatar=!0,t.imagePath=e.target.result,a.src=t.imagePath,t.stage=t.initCanvas(t.imagePath,1),t.cropper=new Cropper(a,{aspectRatio:180/76,crop:function(e){t.onUpdateCropPreview(e.detail)}})}},onUpdateCropPreview:function(e){var t=e.width/180;this.bluePlayerCard&&this.bluePlayerCard.avatarBmp&&(this.bluePlayerCard.avatarBmp.x=-e.x/t,this.bluePlayerCard.avatarBmp.y=-e.y/t,this.bluePlayerCard.avatarBmp.scaleX=this.bluePlayerCard.avatarBmp.scaleY=1/t,this.redPlayerCard.avatarBmp.x=-e.x/t,this.redPlayerCard.avatarBmp.y=-e.y/t,this.redPlayerCard.avatarBmp.scaleX=this.redPlayerCard.avatarBmp.scaleY=1/t)},initCanvas:function(e,t){},onFtSelected:function(e){console.log("onFtSelected",e,this.ftId)}},ready:function(){var e=this;r=this,this.isEdit=!1,this.isChangeAvatar=!1,this.$on(a.ViewEvent.PLAYER_ADD,function(t){e.ftOptionArr=t.ftOptionArr.concat({text:"退团保平安",value:0})}),this.$on(a.ViewEvent.PLAYER_EDIT,function(t){var n=t.playerId;e.ftOptionArr=t.ftOptionArr.concat({text:"退团保平安",value:0}),e.isEdit=!0,e.isChangeAvatar=!1,e.post("/db/player/"+n,function(t){console.log("res: ",t);var n=t.playerDoc;e.editPlayerId=n.id,e.stage=e.initCanvas(n.avatar,1),e.setProp(n,e),e.avatar=n.avatar}),console.log(a.ViewEvent.PLAYER_EDIT,n)})}}},function(e,t){"use strict";function n(e){return e}t.PanelId={stagePanel:"stage",stage1v1Panel:"stage1v1",rkbPanel:"rkb",bracketPanel:"bracket",rankPanel:"rankPanel",onlinePanel:"online",winPanel:"win",actPanel:"act",screenPanel:"screen",playerPanel:"player"},t.FontName={MicrosoftYahei:"Microsoft Yahei"},t.ServerConst={SEND_ASYNC:!0,DEF_AVATAR:"/img/panel/stage1v1/blue.png"},t.ViewConst={STAGE_WIDTH:1920,STAGE_HEIGHT:1080},t.TimerState={START_STR:"start",PAUSE_STR:"pause",PAUSE:0,RUNNING:1},t.ViewEvent={PLAYER_EDIT:"edit player",PLAYER_ADD:"add player",STRAIGHT3_LEFT:"STRAIGHT3_LEFT",STRAIGHT3_RIGHT:"STRAIGHT3_RIGHT"},t.ScParam=n},function(e,t){e.exports='<link href="/js/cropper/cropper.css" rel="stylesheet">\r\n<!-- Modaler Structure -->\r\n<div id="modal-player" class="modal modal-fixed-footer" style="max-height:1080px;top:5%;width: 85%;height: 85%">\r\n    <div class="modal-content">\r\n        <h4>球员信息</h4>\r\n        <div class="row">\r\n            <div class="col s6">\r\n                <div class="row">\r\n                    <canvas id="avatarPreview"></canvas>\r\n                </div>\r\n                <div class="row">\r\n                    <div class="input-field col s4">\r\n                        <!--<label for="name">显示ID</label>-->\r\n                        显示ID<input id="name" v-model="name" type="text" class="validate" length="5">\r\n                    </div>\r\n                </div>\r\n                <div class="row">\r\n                    <div class="input-field col s2">\r\n                        身高(CM)<input id="height" v-model="height" type="text" class="validate">\r\n                        <!--<label for="height">身高(CM)</label>-->\r\n                    </div>\r\n\r\n                    <div class="input-field col s2">\r\n                        体重(KG) <input id="weight" v-model="weight" type="text" class="validate">\r\n                    </div>\r\n                    <div class="input-field col s2">\r\n                        地区 <input v-model="location" type="text" class="validate">\r\n                    </div>\r\n                </div>\r\n                <div class="row">\r\n                    <div class="input-field col s12">\r\n                        一句话介绍 <input v-model="intro" type="text" class="validate">\r\n                    </div>\r\n\r\n                    战团： <select class="browser-default" v-model="ftId" @change="onFtSelected"\r\n                                style="width: 150px">\r\n                    <option v-for="option in ftOptionArr" v-bind:value="option.value">\r\n                        {{ option.text }}\r\n                    </option>\r\n                </select>\r\n                    <div class="row">\r\n                        <div class="input-field col s2">\r\n                            本轮得分:<input v-model="curFtScore" type="text" class="validate">\r\n                        </div>\r\n\r\n                        <div class="input-field col s2">\r\n                            总得分: <input v-model="ftScore" type="text" class="validate">\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div class="col s6">\r\n                <div class="file-field input-field">\r\n                    <div class="btn">\r\n                        <span>选择文件</span>\r\n                        <input type="file" id="file1" @change="showFile($event)"/>\r\n                    </div>\r\n                    <div class="file-path-wrapper">\r\n                        <input class="file-path validate" type="text">\r\n                    </div>\r\n                </div>\r\n\r\n                <div>\r\n                    <img id="image">\r\n                </div>\r\n                <br>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div class="modal-footer">\r\n        <a @click="onDeletePlayer" class="left modal-action modal-close waves-effect waves-green btn-flat">\r\n            <i class="material-icons">delete</i>\r\n        </a>\r\n        <a @click="onSubmitInfo($event)" class="modal-action waves-effect waves-green btn-flat">\r\n            <i class="material-icons">done</i>\r\n        </a>\r\n    </div>\r\n</div>\r\n\r\n\r\n        '},function(e,t){"use strict";var n;!function(e){e[e.dmkPush=0]="dmkPush",e[e.toggleTracker=1]="toggleTracker",e[e.toggleBallRolling=2]="toggleBallRolling",e[e.toggleTimer=3]="toggleTimer",e[e.cs_toggleTimer=4]="cs_toggleTimer",e[e.resetTimer=5]="resetTimer",e[e.disableTracker=6]="disableTracker",e[e.updateLeftScore=7]="updateLeftScore",e[e.cs_addLeftScore=8]="cs_addLeftScore",e[e.updateRightScore=9]="updateRightScore",e[e.cs_addRightScore=10]="cs_addRightScore",e[e.updateLeftBall=11]="updateLeftBall",e[e.updateRightBall=12]="updateRightBall",e[e.cs_addLeftBall=13]="cs_addLeftBall",e[e.cs_addRightBall=14]="cs_addRightBall",e[e.cs_minLeftBall=15]="cs_minLeftBall",e[e.cs_minRightBall=16]="cs_minRightBall",e[e.cs_updateInitBallCount=17]="cs_updateInitBallCount",e[e.minLeftScore=18]="minLeftScore",e[e.cs_minLeftScore=19]="cs_minLeftScore",e[e.minRightScore=20]="minRightScore",e[e.cs_minRightScore=21]="cs_minRightScore",e[e.updateLeftFoul=22]="updateLeftFoul",e[e.cs_addLeftFoul=23]="cs_addLeftFoul",e[e.cs_minLeftFoul=24]="cs_minLeftFoul",e[e.updateRightFoul=25]="updateRightFoul",e[e.cs_addRightFoul=26]="cs_addRightFoul",e[e.cs_minRightFoul=27]="cs_minRightFoul",e[e.cs_updateLeftSkill=28]="cs_updateLeftSkill",e[e.updateLeftSkill=29]="updateLeftSkill",e[e.cs_updateRightSkill=30]="cs_updateRightSkill",e[e.updateRightSkill=31]="updateRightSkill",e[e.stageFadeOut=32]="stageFadeOut",e[e.cs_fadeOut=33]="cs_fadeOut",e[e.playerScore=34]="playerScore",e[e.cs_playerScore=35]="cs_playerScore",e[e.stageFadeIn=36]="stageFadeIn",e[e.cs_stageFadeIn=37]="cs_stageFadeIn",e[e.moveStagePanel=38]="moveStagePanel",e[e.cs_moveStagePanel=39]="cs_moveStagePanel",e[e.updatePlayer=40]="updatePlayer",e[e.cs_updatePlayer=41]="cs_updatePlayer",e[e.updatePlayerAll=42]="updatePlayerAll",e[e.cs_changeColor=43]="cs_changeColor",e[e.cs_updatePlayerAll=44]="cs_updatePlayerAll",e[e.cs_updatePlayerBackNum=45]="cs_updatePlayerBackNum",e[e.updatePlayerBackNum=46]="updatePlayerBackNum",e[e.fadeInNotice=47]="fadeInNotice",e[e.cs_fadeInNotice=48]="cs_fadeInNotice",e[e.cs_resetGame=49]="cs_resetGame",e[e.cs_toggleDmk=50]="cs_toggleDmk",e[e.toggleDmk=51]="toggleDmk",e[e.resetGame=52]="resetGame",e[e.cs_unLimitScore=53]="cs_unLimitScore",e[e.unLimitScore=54]="unLimitScore",e[e.cs_updatePlayerState=55]="cs_updatePlayerState",e[e.updatePlayerState=56]="updatePlayerState",e[e.cs_setGameIdx=57]="cs_setGameIdx",e[e.setGameIdx=58]="setGameIdx",e[e.fadeInWinPanel=59]="fadeInWinPanel",e[e.cs_fadeInWinPanel=60]="cs_fadeInWinPanel",e[e.fadeOutWinPanel=61]="fadeOutWinPanel",e[e.cs_fadeOutWinPanel=62]="cs_fadeOutWinPanel",e[e.saveGameRec=63]="saveGameRec",e[e.cs_saveGameRec=64]="cs_saveGameRec",e[e.cs_fadeInFinalPlayer=65]="cs_fadeInFinalPlayer",e[e.fadeInFinalPlayer=66]="fadeInFinalPlayer",e[e.cs_fadeOutFinalPlayer=67]="cs_fadeOutFinalPlayer",e[e.fadeOutFinalPlayer=68]="fadeOutFinalPlayer",e[e.cs_setActPlayer=69]="cs_setActPlayer",e[e.cs_setBracketPlayer=70]="cs_setBracketPlayer",e[e.cs_clearActPlayerGameRec=71]="cs_clearActPlayerGameRec",e[e.cs_getBracketPlayerByIdx=72]="cs_getBracketPlayerByIdx",e[e.cs_refreshClient=73]="cs_refreshClient",e[e.refreshClient=74]="refreshClient",e[e.cs_updateWinScore=75]="cs_updateWinScore",e[e.updateWinScore=76]="updateWinScore",e[e.cs_updateKingPlayer=77]="cs_updateKingPlayer",e[e.updateKingPlayer=78]="updateKingPlayer",e[e.cs_setCursorPlayer=79]="cs_setCursorPlayer",e[e.setCursorPlayer=80]="setCursorPlayer",e[e.cs_saveToTotalScore=81]="cs_saveToTotalScore",e[e.cs_setScorePanelVisible=82]="cs_setScorePanelVisible",e[e.setScorePanelVisible=83]="setScorePanelVisible",e[e.cs_autoSaveGameRec=84]="cs_autoSaveGameRec",e[e.cs_setDelayTime=85]="cs_setDelayTime",e[e.sc_setDelayTime=86]="sc_setDelayTime",e[e.cs_showRank=87]="cs_showRank",e[e.sc_showRank=88]="sc_showRank",e[e.cs_showBracket=89]="cs_showBracket",e[e.sc_showBracket=90]="sc_showBracket",e[e.cs_hideOnlinePanel=91]="cs_hideOnlinePanel",e[e.sc_hideOnlinePanel=92]="sc_hideOnlinePanel",e[e.cs_resetTimer=93]="cs_resetTimer",e[e.sc_resetTimer=94]="sc_resetTimer",e[e.cs_startTimer=95]="cs_startTimer",e[e.sc_startTimer=96]="sc_startTimer",e[e.cs_pauseTimer=97]="cs_pauseTimer",e[e.sc_pauseTimer=98]="sc_pauseTimer",e[e.cs_startingLine=99]="cs_startingLine",e[e.startingLine=100]="startingLine",e[e.cs_hideStartingLine=101]="cs_hideStartingLine",e[e.hideStartingLine=102]="hideStartingLine",e[e.cs_queryPlayerByPos=103]="cs_queryPlayerByPos",e[e.fadeInPlayerPanel=104]="fadeInPlayerPanel",e[e.cs_fadeInPlayerPanel=105]="cs_fadeInPlayerPanel",e[e.fadeOutPlayerPanel=106]="fadeOutPlayerPanel",e[e.cs_fadeOutPlayerPanel=107]="cs_fadeOutPlayerPanel",e[e.movePlayerPanel=108]="movePlayerPanel",e[e.cs_movePlayerPanel=109]="cs_movePlayerPanel",e[e.straightScore3=110]="straightScore3",e[e.straightScore5=111]="straightScore5",e[e.initPanel=112]="initPanel",e[e.cs_fadeInActivityPanel=113]="cs_fadeInActivityPanel",e[e.fadeInActivityPanel=114]="fadeInActivityPanel",e[e.cs_fadeInNextActivity=115]="cs_fadeInNextActivity",e[e.fadeInNextActivity=116]="fadeInNextActivity",e[e.cs_fadeInActivityExGame=117]="cs_fadeInActivityExGame",e[e.fadeInActivityExGame=118]="fadeInActivityExGame",e[e.cs_fadeOutActivityPanel=119]="cs_fadeOutActivityPanel",e[e.fadeOutActivityPanel=120]="fadeOutActivityPanel",e[e.cs_startGame=121]="cs_startGame",e[e.cs_restartGame=122]="cs_restartGame",e[e.cs_fadeInRankPanel=123]="cs_fadeInRankPanel",e[e.fadeInRankPanel=124]="fadeInRankPanel",e[e.cs_fadeInNextRank=125]="cs_fadeInNextRank",e[e.fadeInNextRank=126]="fadeInNextRank",e[e.cs_setGameComing=127]="cs_setGameComing",e[e.setGameComing=128]="setGameComing",e[e.cs_fadeOutRankPanel=129]="cs_fadeOutRankPanel",e[e.fadeOutRankPanel=130]="fadeOutRankPanel",e[e.cs_fadeInCountDown=131]="cs_fadeInCountDown",e[e.fadeInCountDown=132]="fadeInCountDown",e[e.cs_fadeOutCountDown=133]="cs_fadeOutCountDown",e[e.fadeOutCountDown=134]="fadeOutCountDown",e[e.cs_inScreenScore=135]="cs_inScreenScore",e[e.inScreenScore=136]="inScreenScore",e[e.cs_fadeInFTShow=137]="cs_fadeInFTShow",e[e.fadeInFTShow=138]="fadeInFTShow",e[e.cs_fadeOutFTShow=139]="cs_fadeOutFTShow",e[e.fadeOutFTShow=140]="fadeOutFTShow",e[e.cs_fadeInPlayerRank=141]="cs_fadeInPlayerRank",e[e.fadeInPlayerRank=142]="fadeInPlayerRank",e[e.cs_fadeInFtRank=143]="cs_fadeInFtRank",e[e.fadeInFtRank=144]="fadeInFtRank",e[e.cs_fadeInMixRank=145]="cs_fadeInMixRank",e[e.fadeInMixRank=146]="fadeInMixRank",e[e.cs_findPlayerData=147]="cs_findPlayerData",e[e.cs_attack=148]="cs_attack",e[e.attack=149]="attack",e[e.cs_addHealth=150]="cs_addHealth",e[e.addHealth=151]="addHealth",e[e.fadeInOK=152]="fadeInOK",e[e.cs_combo=153]="cs_combo",e[e.combo=154]="combo"}(n||(n={})),t.CommandId={};for(var a in n)t.CommandId[a]=a},function(e,t){e.exports='<aside class="menu">\r\n    <p class="menu-label">\r\n        Player\r\n    </p>\r\n    <ul class="menu-list">\r\n        <ul>\r\n            <li><a href="#">添加Player</a></li>\r\n            <li><a href="#">同步数据</a></li>\r\n        </ul>\r\n    </ul>\r\n    <!--<div class="ui bulleted list col s2" style="position: absolute;left: 30px">-->\r\n        <!--<div class="item">-->\r\n            <!--<div>Player</div>-->\r\n            <!--<div class="list">-->\r\n                <!--<a class="item" href="#">添加Player</a>-->\r\n                <!--<a class="item" href="#">同步数据</a>-->\r\n            <!--</div>-->\r\n        <!--</div>-->\r\n        <!--<div class="item">Inviting Friends</div>-->\r\n        <!--<div class="item">-->\r\n            <!--<div>Benefits</div>-->\r\n            <!--<div class="list">-->\r\n                <!--<a class="item" href="#">Link to somewhere</a>-->\r\n                <!--<div class="item">Rebates</div>-->\r\n                <!--<div class="item">Discounts</div>-->\r\n            <!--</div>-->\r\n        <!--</div>-->\r\n    <!--</div>-->\r\n    <div id="player-grid" class="col s10" style="position: relative;left: 290px">\r\n        <div class="row" v-for="player in playerArr" style="display: inline-block;margin: 0">\r\n            <div class="col s12">\r\n                <div class="ui small fade reveal image">\r\n                    <img class="visible content" src="{{player.avatar}}" style="width: 300px;height: 300px;">\r\n                    <div class="hidden content">\r\n                         <span class="card-title activator grey-text text-darken-4">{{player.name}}\r\n                                <i class="material-icons right" @click="onEdit(player.id,$event)">mode_edit</i></span>\r\n                        本轮得分:{{player.curFtScore}}\r\n                        总分:{{player.ftScore}}\r\n                        id:{{player.id}}\r\n                    </div>\r\n                </div>\r\n                <!--<div class="card small" style="width:300px;height: 300px">-->\r\n                <!--<i class="material-icons left waves-effect waves-block waves-light"-->\r\n                <!--@click="onPickPlayer(player.id)">playlist_add</i>-->\r\n                <!--<div class="card-image waves-effect waves-block waves-light">-->\r\n                <!--<img class="activator" src="{{player.avatar}}">-->\r\n                <!--</div>-->\r\n                <!--<div class="card-content">-->\r\n                <!--<span class="card-title activator grey-text text-darken-4">{{player.name}}-->\r\n                <!--<i class="material-icons right" @click="onEdit(player.id,$event)">mode_edit</i></span>-->\r\n                <!--本轮得分:{{player.curFtScore}}-->\r\n                <!--总分:{{player.ftScore}}-->\r\n                <!--id:{{player.id}}-->\r\n                <!--</div>-->\r\n                <!--<div class="card-reveal">-->\r\n                <!--<span class="card-title grey-text text-darken-4">战绩<i-->\r\n                <!--class="material-icons right">close</i></span>-->\r\n                <!--<p></p>-->\r\n                <!--</div>-->\r\n                <!--</div>-->\r\n            </div>\r\n        </div>\r\n    </div>\r\n</aside>\r\n\r\n\r\n'},function(e,t,n){"use strict";var a=n(13),r=n(14),i=n(16);t.RankView={template:n(18),props:{playerDocArr:{type:Array},gameRecArr:{type:Array},playerMap:{type:Array},playerGameRecArr:{type:Array},pageIdx:{type:Number},playerGameRecPageArr:{type:Array}},mounted:function(){var e=this;console.log("rank"),this.playerGameRecArr=[{left:{name:"player3",score:1},right:{name:"player1",score:2}}];var t,n=[],i=[],o=function(s){if(s<n.length){t=n[s];var l="http://api.liangle.com/api/passerbyking/game/match/"+t;$.get("http://"+window.location.host+"/get?url="+l,function(e){var a=JSON.parse(e.entity);console.log(a),a.round=t,i.push(a);var r=Math.floor((s+1)/n.length*100);console.log("progress",r),$("#progress1").val(r),o(s+1)})}else{e.gameRecArr=[];var c=r.getEloRank(i,e.gameRecArr);e.playerMap=c,setInterval(function(){$("#progress1").hide(),e.playerDocArr=a.mapToArr(c).sort(a.descendingProp("eloScore"))},500)}},s="http://api.liangle.com/api/passerbyking/game/list";$.get("http://"+window.location.host+"/get?url="+s,function(e){var t=JSON.parse(e.entity).data;console.log(t);for(var a=0;a<t.length;a++){var r=t[a];n.push(r.id)}o(0)})},methods:{onSortWinPercent:function(){console.log("onSortWinPercent")},onClkGameRecPage:function(e){this.playerGameRecArr=this.playerGameRecPageArr[e]},onShowRec:function(e){this.playerGameRecArr=[],this.playerGameRecPageArr=[];for(var t=10,n=[],a=0;a<this.gameRecArr.length;a++){var r=this.gameRecArr[a];r.left.name!=e&&r.right.name!=e||(r.left.name==e&&(r.win=r.left.score>r.right.score),r.right.name==e&&(r.win=r.left.score<r.right.score),r.name=e,n.push(r),n.length%t==0&&(this.playerGameRecPageArr.push(n),n=[]))}n.length&&this.playerGameRecPageArr.push(n),this.playerGameRecArr=this.playerGameRecPageArr[0],console.log("onShowRec",e,this.playerGameRecPageArr.length)},onSortGameCount:function(){for(var e=0,t=this.playerDocArr;e<t.length;e++){var n=t[e];n.gameCount=i.PlayerInfo.gameCount(n)}this.playerDocArr.sort(a.descendingProp("gameCount")),console.log("onSortGameCount")}}}},function(e,t){"use strict";function n(e){return function(t,n){return t[e]-n[e]}}function a(e){return function(t,n){return n[e]-t[e]}}function r(e,t,n){var a=[];for(var r in e)a.push(e[r]);return a.sort(n(t)),a}function i(e,t){var n=[];for(var a in e)n.push(e[a]);return t&&(n=JSON.parse(JSON.stringify(n))),n}function o(e,t){for(var n=0,a=0;a<t.length;a++){var r=t[a];e.indexOf(r)>-1&&n++}return n}function s(e,t,n){return t==n.indexOf(e)}function l(e,t){var n=new Image;n.onload=function(){t(n)},n.src=e}function c(e,t){function n(){i--,0===i&&(i=-1,t(a))}var a,r,i=e.length;i&&e[0].hasOwnProperty("name")&&e[0].hasOwnProperty("url")?(r=!1,a={}):(r=!0,a=[]);for(var o,s,l=0;l<e.length;l++){var c=e[l];o=new Image,r?(a.push(o),s=c):(a[c.name]=o,s=c.url),o.onload=n,o.src=s}}function d(e,t){var n=[];return function e(t,a,r){if(0==r)return n.push(t);for(var i=0,o=a.length;i<=o-r;i++)e(t.concat(a[i]),a.slice(i+1),r-1)}([],e,t),n}function p(e,t,n){void 0===t&&(t=":"),void 0===n&&(n="");var a=Math.floor(e/60),r=e%60,i=a+"",o=r+"";return a<10&&(i="0"+i),r<10&&(o="0"+o),i+t+o+n}function u(e){for(var t=0,n=e.length,a=-1,r=0;r<n;r++)a=e.charCodeAt(r),t+=a>=0&&a<=128?1:2;return t}function h(e,t,n){void 0===n&&(n=0);for(var a=0,r=e.length,i=new String,o="",s=n;s<r;s++){var l=e.charAt(s);a++,escape(l).length>4&&a++,i=i.concat(l),a>=t&&(o+=i.concat("\n"),i=new String,a=0)}return o+=i}t.ascendingProp=n,t.descendingProp=a,t.mapToSortArray=r,t.mapToArr=i,t.arrCountSame=o,t.arrUniqueFilter=s,t.loadImg=l,t.loadImgArr=c,t.combineArr=d,t.formatSecond=p,t.getLength=u,t.cnWrap=h,t.getUrlFilename=function(e){var t=e.split("/"),n=t[t.length-1];return n},t.DateFormat=function(e,t){var n={"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),S:e.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length)));for(var a in n)new RegExp("("+a+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?n[a]:("00"+n[a]).substr((""+n[a]).length)));return t}},function(e,t,n){"use strict";var a=n(15);t.getEloRank=function(e,t){for(var n={},r=e,i=0;i<r.length;i++)for(var o=r[i],s=1;;s++){var l=o.data[s];if(!l)break;var c=l.left,d=l.right;n[c.name]||(n[c.name]={name:c.name,winGameCount:0,loseGameCount:0,roundCount:0,score:0,eloScore:2e3}),n[d.name]||(n[d.name]={name:d.name,winGameCount:0,loseGameCount:0,roundCount:0,score:0,eloScore:2e3});var p=n[c.name],u=n[d.name];t.push({round:o.round,left:{name:p.name,score:c.score},right:{name:u.name,score:d.score}});var h=a.EloUtil.classicMethod(p.eloScore,u.eloScore);p.score+=c.score,u.score+=d.score,c.score>d.score?(p.eloScore+=h,u.eloScore-=h,p.winGameCount+=1,u.loseGameCount+=1):(p.eloScore-=h,u.eloScore+=h,p.loseGameCount+=1,u.winGameCount+=1)}return n}},function(e,t){"use strict";t.EloConf={score:2e3,K:32};var n=function(){function e(){}return e.classicMethod=function(e,n){var a=e,r=n,i=t.EloConf.K,o=r-a,s=1/(1+Math.pow(10,o/400)),l=Math.round(i*(1-s));return l},e.playerToWinMethod=function(e,t){},e}();t.EloUtil=n},function(e,t,n){"use strict";var a=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},r=n(17),i=function(){function e(){this.id=0,this.name="",this.phone=0,this.eloScore=0,this.style=0,this.avatar="",this.height=0,this.weight=0,this.dtScore=0,this.activityId=0,this.gameRec=[],this.loseGameCount=0,this.winGameCount=0,this.ftId=0,this.ftScore=0,this.playerNum=0,this.curFtScore=0,this.location="上海"}return e}();t.PlayerDoc=i,t.PlayerState1v1={FIGHTING:" ",PIGEON:"鸽子",WAITING:"  ",Dead:"淘汰"};var o=function(e){function t(t){e.call(this),this.playerData=new i,this.isRed=!0,this.isMvp=!1,this.backNumber=0,t&&(null!=t.playerData?(this.playerData=r.obj2Class(t.playerData,i),this.setPlayerInfoFromData(t)):(this.playerData=r.obj2Class(t,i),this.setPlayerInfoFromData(t)))}return a(t,e),t.prototype.setPlayerInfoFromData=function(e){null!=e.isRed&&(this.isRed=e.isRed),null!=e.isMvp&&(this.isMvp=e.isMvp),null!=e.backNumber&&(this.backNumber=e.backNumber)},t.prototype.getPlayerData=function(){return this.playerData.isRed=this.isRed,this.playerData.isMvp=this.isMvp,this.playerData.backNumber=this.backNumber,this.playerData},t.prototype.id=function(e){return r.prop(this.playerData,"id",e)},t.prototype.phone=function(e){return r.prop(this.playerData,"phone",e)},t.prototype.name=function(e){return r.prop(this.playerData,"name",e)},t.prototype.activityId=function(e){return r.prop(this.playerData,"activityId",e)},t.prototype.eloScore=function(e){return r.prop(this.playerData,"eloScore",e)},t.prototype.dtScore=function(e){return r.prop(this.playerData,"dtScore",e)},t.prototype.style=function(e){return r.prop(this.playerData,"style",e)},t.prototype.avatar=function(e){return r.prop(this.playerData,"avatar",e)},t.prototype.gameRec=function(e){return r.prop(this.playerData,"gameRec",e)},t.winPercent=function(e){var n=e.winGameCount/t.gameCount(e);return n||(n=0),
n},t.winPercentStr=function(e){return(100*t.winPercent(e)).toFixed(1)+"%"},t.weight=function(e){return e.weight||e.playerData.weight},t.height=function(e){return e.height||e.playerData.height},t.intro=function(e){return e.intro||e.playerData.intro},t.prototype.winpercent=function(e){return this.winGameCount()/this.gameCount()},t.gameCount=function(e){return e.loseGameCount+e.winGameCount||0},t.addWinGameAmount=function(e){return e.winGameCount++,e.winGameCount},t.addLoseGameAmount=function(e){return e.loseGameCount++,e.loseGameCount},t.prototype.gameCount=function(){return this.loseGameCount()+this.winGameCount()},t.prototype.winGameCount=function(e){return r.prop(this.playerData,"winGameCount",e)},t.prototype.loseGameCount=function(e){return r.prop(this.playerData,"loseGameCount",e)},t.prototype.getWinPercent=function(){return(100*this.winpercent()).toFixed(1)+"%"},t.getStyleIcon=function(e){var t="/img/panel/stage/";return 1===e?t+="feng.png":2===e?t+="lin.png":3===e?t+="huo.png":4===e&&(t+="shan.png"),t},t.prototype.getWinStyleIcon=function(){var e="/img/panel/stage/win/";return 1==this.style()?e+="fengWin.png":2==this.style()?e+="linWin.png":3==this.style()?e+="huoWin.png":4==this.style()&&(e+="shanWin.png"),e},t.prototype.getRec=function(){return{id:this.id(),eloScore:this.eloScore(),dtScore:this.dtScore()}},t.prototype.saveScore=function(e,t){this.dtScore(e),this.eloScore(this.eloScore()+e),t?this.winGameCount(this.winGameCount()+1):this.loseGameCount(this.loseGameCount()+1)},t.prototype.getCurWinningPercent=function(){return this.winGameCount()/(this.loseGameCount()+this.winGameCount())},t}(r.BaseInfo);t.PlayerInfo=o},function(e,t){"use strict";function n(e,t){for(var n in e)t.hasOwnProperty(n)&&(t[n]=e[n])}t.isdef=function(e){return void 0!=e},t.prop=function(e,n,a,r){return t.isdef(a)?(e[n]=a,void(r&&r())):e[n]},t.obj2Class=function(e,t){var n=new t;for(var a in e)n[a]=e[a];return n},t.setPropTo=n;var a=function(){function e(){}return e}();t.BaseDoc=a;var r=function(){function e(){}return e}();t.BaseInfo=r},function(e,t){e.exports='<!--<script src="../../../../../yqbe/src/utils/nmserver/app.js"></script>-->\r\n<div>\r\n    <progress id="progress1" class="progress is-success" value="0" max="100"></progress>\r\n    <div class="ui two column grid" style="">\r\n        <table class="table is-striped">\r\n            <thead>\r\n            <tr>\r\n                <th width="50px"></th>\r\n                <th width="150px">ID</th>\r\n                <th width="50px" @click="onSortGameCount">场数</th>\r\n                <th width="70px" @click="onSortWinPercent">胜率</th>\r\n                <th width="70px">贡献值</th>\r\n                <th width="70px">天梯分</th>\r\n                <th>战绩</th>\r\n            </tr>\r\n            </thead>\r\n            <tbody>\r\n            <tr v-for="(playerDoc,index) in playerDocArr">\r\n                <!--<td><img src="{{playerDoc.avatar}}" style="width: 100px"></td>-->\r\n                <td v-text="index+1"></td>\r\n                <td v-text="playerDoc.name"></td>\r\n                <td v-text="(playerDoc.winGameCount+playerDoc.loseGameCount)||0"></td>\r\n                <td v-text="(playerDoc.winGameCount/(playerDoc.winGameCount+playerDoc.loseGameCount)*100||0).toFixed(2)+\'%\'"></td>\r\n                <td v-text="playerDoc.score"></td>\r\n                <td v-text="playerDoc.eloScore"></td>\r\n                <td>\r\n                    <button class="ui right labeled icon button showRec" @click="onShowRec(playerDoc.name)">\r\n                        <i class="right arrow icon"></i>\r\n                        查看\r\n                    </button>\r\n                </td>\r\n            </tr>\r\n            </tbody>\r\n        </table>\r\n\r\n        <div class="four wide column" style="position: fixed;left:650px;top: 60px;">\r\n            <table class="ui striped table">\r\n                <thead>\r\n                <tr>\r\n                    <th>round</th>\r\n                    <th width="150px">ID</th>\r\n                    <th width="80px">VS</th>\r\n                    <th width="150px">ID</th>\r\n                </tr>\r\n                </thead>\r\n                <tbody>\r\n                <tr v-for="(rec,index) in playerGameRecArr" :class="[{ positive: rec.win }, { negative: !rec.win }]">\r\n                    <td v-text="rec.round"></td>\r\n                    <td v-text="rec.left.name" :class="{bold:rec.name==rec.left.name}"></td>\r\n                    <td v-text="rec.left.score+\' : \'+rec.right.score"></td>\r\n                    <td v-text="rec.right.name" :class="{bold:rec.name==rec.right.name}"></td>\r\n                </tr>\r\n                </tbody>\r\n                <tfoot>\r\n                <tr>\r\n                    <th colspan="3">\r\n                        <div class="ui right floated pagination menu">\r\n                            <a class="icon item">\r\n                                <i class="left chevron icon"></i>\r\n                            </a>\r\n                            <a class="item " v-for="(page,pageIdx) in playerGameRecPageArr"\r\n                               @click="onClkGameRecPage(pageIdx)">{{pageIdx+1}}</a>\r\n                            <a class="icon item">\r\n                                <i class="right chevron icon"></i>\r\n                            </a>\r\n                        </div>\r\n                    </th>\r\n                </tr>\r\n                </tfoot>\r\n            </table>\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n'},function(e,t,n){"use strict";t.PanelView={template:n(20),props:{selected:null,options:null},watch:{selected:"onSelGameID"},gameDataArr:null,created:function(){var e=this,t="http://api.liangle.com/api/passerbyking/game/list";$.get("http://"+window.location.host+"/get?url="+t,function(t){var n=JSON.parse(t.entity);console.log(n);var a=n.data;e.gameDataArr=a;for(var r=0;r<a.length;r++){var i=a[r];i.text="["+i.id+"]:"+i.title,i.value=i.id}e.options=a})},mounted:function(){},methods:{onClkSync:function(){console.log("onClkSync")},onSelGameID:function(){$.get("http://"+window.location.host+"/admin/sync/"+this.selected,function(e){console.log(e)})}}}},function(e,t){e.exports='<div>\r\n    <span class="select">\r\n        <select v-model="selected">\r\n            <option v-for="option in options" v-bind:value="option.value">\r\n                {{ option.text }}\r\n            </option>\r\n        </select>\r\n        Game ID: {{ selected }}\r\n        <button class="button is-primary" @click="onClkSync">同步</button>\r\n    </span>\r\n\r\n    <div class="card" v-for="(player,index) in playerArr">\r\n        <div class="card-image">\r\n            <figure class="image is-4by4">\r\n                <img src="{{player.avatar}}">\r\n            </figure>\r\n        </div>\r\n        <div class="card-content">\r\n            <div class="media">\r\n                <div class="media-left">\r\n                    <figure class="image is-32x32">\r\n                        <img src="http://placehold.it/64x64" alt="Image">\r\n                    </figure>\r\n                </div>\r\n                <div class="media-content">\r\n                    <p class="title is-5">{{player.name}}</p>\r\n                    <p class="subtitle is-6">@johnsmith</p>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>'}]);
//# sourceMappingURL=admin.js.map