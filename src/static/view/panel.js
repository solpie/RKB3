!function(e){function t(n){if(a[n])return a[n].exports;var r=a[n]={exports:{},id:n,loaded:!1};return e[n].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var a={};return t.m=e,t.c=a,t.p="",t(0)}([function(e,t,a){"use strict";a(!function(){var e=new Error('Cannot find module "script!./../../../clientLibs/createjs/createjs.min.js"');throw e.code="MODULE_NOT_FOUND",e}()),a(!function(){var e=new Error('Cannot find module "script!./../../../clientLibs/createjs/easeljs.min.js"');throw e.code="MODULE_NOT_FOUND",e}()),a(!function(){var e=new Error('Cannot find module "script!./../../../clientLibs/createjs/tweenjs.min.js"');throw e.code="MODULE_NOT_FOUND",e}()),a(!function(){var e=new Error('Cannot find module "script!./../../../clientLibs/pixi.min.js"');throw e.code="MODULE_NOT_FOUND",e}()),a(!function(){var e=new Error('Cannot find module "script!./../../../clientLibs/TweenLite.min.js"');throw e.code="MODULE_NOT_FOUND",e}()),a(!function(){var e=new Error('Cannot find module "script!./../../../clientLibs/jquery.min.js"');throw e.code="MODULE_NOT_FOUND",e}()),a(!function(){var e=new Error('Cannot find module "script!./../../../clientLibs/qrcode.min.js"');throw e.code="MODULE_NOT_FOUND",e}()),a(!function(){var e=new Error('Cannot find module "script!./../../../clientLibs/socket.io-1.4.5.min.js"');throw e.code="MODULE_NOT_FOUND",e}()),a(!function(){var e=new Error('Cannot find module "script!./../../../clientLibs/vue/vue.min.js"');throw e.code="MODULE_NOT_FOUND",e}()),a(!function(){var e=new Error('Cannot find module "script!./../../../clientLibs/vue/vue-router.min.js"');throw e.code="MODULE_NOT_FOUND",e}()),a(!function(){var e=new Error('Cannot find module "script!./../../../clientLibs/webfontloader.js"');throw e.code="MODULE_NOT_FOUND",e}()),WebFont.load({google:{families:["Droid Sans","Droid Serif"]}});var n=a(21),r=a(34),i=[{path:"/",name:"panel",components:{default:n.rkbView}},{path:"/rkb/:op/:game_id",components:{default:n.rkbView}},{path:"/ol/:op/:game_id",components:{default:r.stageOnlineView}}],o=new VueRouter({routes:i});o.afterEach(function(e,t){});new Vue({router:o}).$mount("#panel")},,,,function(e,t){"use strict";var a=function(){function e(){this.props={},this.methods={}}return e.initProps=function(e){for(var t in e){var a=e[t];if(a.hasOwnProperty("_"))a.hasOwnProperty("v")?e.props[t]=a.v:a.hasOwnProperty("f")&&(e.methods[t]=a.f);else{var n=a instanceof Function;n&&(e.methods[t]=a)}}},e.prototype.created=function(){},e.prototype.mounted=function(){},e.PROP={v:null,_:null},e.Dict={v:{},_:null},e.Number={v:0,_:null},e.String={v:"",_:null},e}();t.VueBase=a},,,,function(e,t){"use strict";function a(e){return e}t.PanelId={stagePanel:"stage",stage1v1Panel:"stage1v1",rkbPanel:"rkb",bracketPanel:"bracket",rankPanel:"rankPanel",onlinePanel:"online",winPanel:"win",actPanel:"act",screenPanel:"screen",playerPanel:"player"},t.FontName={MicrosoftYahei:"Microsoft Yahei"},t.ServerConst={SEND_ASYNC:!0,DEF_AVATAR:"/img/panel/stage1v1/blue.png"},t.ViewConst={STAGE_WIDTH:1920,STAGE_HEIGHT:1080},t.TimerState={START_STR:"start",PAUSE_STR:"pause",PAUSE:0,RUNNING:1},t.ViewEvent={PLAYER_EDIT:"edit player",PLAYER_ADD:"add player",STRAIGHT3_LEFT:"STRAIGHT3_LEFT",STRAIGHT3_RIGHT:"STRAIGHT3_RIGHT"},t.ScParam=a},,function(e,t){"use strict";var a;!function(e){e[e.dmkPush=0]="dmkPush",e[e.toggleTracker=1]="toggleTracker",e[e.toggleBallRolling=2]="toggleBallRolling",e[e.toggleTimer=3]="toggleTimer",e[e.cs_toggleTimer=4]="cs_toggleTimer",e[e.resetTimer=5]="resetTimer",e[e.disableTracker=6]="disableTracker",e[e.updateLeftScore=7]="updateLeftScore",e[e.cs_addLeftScore=8]="cs_addLeftScore",e[e.updateRightScore=9]="updateRightScore",e[e.cs_addRightScore=10]="cs_addRightScore",e[e.updateLeftBall=11]="updateLeftBall",e[e.updateRightBall=12]="updateRightBall",e[e.cs_addLeftBall=13]="cs_addLeftBall",e[e.cs_addRightBall=14]="cs_addRightBall",e[e.cs_minLeftBall=15]="cs_minLeftBall",e[e.cs_minRightBall=16]="cs_minRightBall",e[e.cs_updateInitBallCount=17]="cs_updateInitBallCount",e[e.minLeftScore=18]="minLeftScore",e[e.cs_minLeftScore=19]="cs_minLeftScore",e[e.minRightScore=20]="minRightScore",e[e.cs_minRightScore=21]="cs_minRightScore",e[e.updateLeftFoul=22]="updateLeftFoul",e[e.cs_addLeftFoul=23]="cs_addLeftFoul",e[e.cs_minLeftFoul=24]="cs_minLeftFoul",e[e.updateRightFoul=25]="updateRightFoul",e[e.cs_addRightFoul=26]="cs_addRightFoul",e[e.cs_minRightFoul=27]="cs_minRightFoul",e[e.cs_updateLeftSkill=28]="cs_updateLeftSkill",e[e.updateLeftSkill=29]="updateLeftSkill",e[e.cs_updateRightSkill=30]="cs_updateRightSkill",e[e.updateRightSkill=31]="updateRightSkill",e[e.stageFadeOut=32]="stageFadeOut",e[e.cs_fadeOut=33]="cs_fadeOut",e[e.playerScore=34]="playerScore",e[e.cs_playerScore=35]="cs_playerScore",e[e.stageFadeIn=36]="stageFadeIn",e[e.cs_stageFadeIn=37]="cs_stageFadeIn",e[e.moveStagePanel=38]="moveStagePanel",e[e.cs_moveStagePanel=39]="cs_moveStagePanel",e[e.updatePlayer=40]="updatePlayer",e[e.cs_updatePlayer=41]="cs_updatePlayer",e[e.updatePlayerAll=42]="updatePlayerAll",e[e.cs_changeColor=43]="cs_changeColor",e[e.cs_updatePlayerAll=44]="cs_updatePlayerAll",e[e.cs_updatePlayerBackNum=45]="cs_updatePlayerBackNum",e[e.updatePlayerBackNum=46]="updatePlayerBackNum",e[e.fadeInNotice=47]="fadeInNotice",e[e.cs_fadeInNotice=48]="cs_fadeInNotice",e[e.cs_resetGame=49]="cs_resetGame",e[e.cs_toggleDmk=50]="cs_toggleDmk",e[e.toggleDmk=51]="toggleDmk",e[e.resetGame=52]="resetGame",e[e.cs_unLimitScore=53]="cs_unLimitScore",e[e.unLimitScore=54]="unLimitScore",e[e.cs_updatePlayerState=55]="cs_updatePlayerState",e[e.updatePlayerState=56]="updatePlayerState",e[e.cs_setGameIdx=57]="cs_setGameIdx",e[e.setGameIdx=58]="setGameIdx",e[e.fadeInWinPanel=59]="fadeInWinPanel",e[e.cs_fadeInWinPanel=60]="cs_fadeInWinPanel",e[e.fadeOutWinPanel=61]="fadeOutWinPanel",e[e.cs_fadeOutWinPanel=62]="cs_fadeOutWinPanel",e[e.saveGameRec=63]="saveGameRec",e[e.cs_saveGameRec=64]="cs_saveGameRec",e[e.cs_fadeInFinalPlayer=65]="cs_fadeInFinalPlayer",e[e.fadeInFinalPlayer=66]="fadeInFinalPlayer",e[e.cs_fadeOutFinalPlayer=67]="cs_fadeOutFinalPlayer",e[e.fadeOutFinalPlayer=68]="fadeOutFinalPlayer",e[e.cs_setActPlayer=69]="cs_setActPlayer",e[e.cs_setBracketPlayer=70]="cs_setBracketPlayer",e[e.cs_clearActPlayerGameRec=71]="cs_clearActPlayerGameRec",e[e.cs_getBracketPlayerByIdx=72]="cs_getBracketPlayerByIdx",e[e.cs_refreshClient=73]="cs_refreshClient",e[e.refreshClient=74]="refreshClient",e[e.cs_updateWinScore=75]="cs_updateWinScore",e[e.updateWinScore=76]="updateWinScore",e[e.cs_updateKingPlayer=77]="cs_updateKingPlayer",e[e.updateKingPlayer=78]="updateKingPlayer",e[e.cs_setCursorPlayer=79]="cs_setCursorPlayer",e[e.setCursorPlayer=80]="setCursorPlayer",e[e.cs_saveToTotalScore=81]="cs_saveToTotalScore",e[e.cs_setScorePanelVisible=82]="cs_setScorePanelVisible",e[e.setScorePanelVisible=83]="setScorePanelVisible",e[e.cs_autoSaveGameRec=84]="cs_autoSaveGameRec",e[e.cs_setDelayTime=85]="cs_setDelayTime",e[e.sc_setDelayTime=86]="sc_setDelayTime",e[e.cs_showRank=87]="cs_showRank",e[e.sc_showRank=88]="sc_showRank",e[e.cs_showBracket=89]="cs_showBracket",e[e.sc_showBracket=90]="sc_showBracket",e[e.cs_hideOnlinePanel=91]="cs_hideOnlinePanel",e[e.sc_hideOnlinePanel=92]="sc_hideOnlinePanel",e[e.cs_resetTimer=93]="cs_resetTimer",e[e.sc_resetTimer=94]="sc_resetTimer",e[e.cs_startTimer=95]="cs_startTimer",e[e.sc_startTimer=96]="sc_startTimer",e[e.cs_pauseTimer=97]="cs_pauseTimer",e[e.sc_pauseTimer=98]="sc_pauseTimer",e[e.cs_startingLine=99]="cs_startingLine",e[e.startingLine=100]="startingLine",e[e.cs_hideStartingLine=101]="cs_hideStartingLine",e[e.hideStartingLine=102]="hideStartingLine",e[e.cs_queryPlayerByPos=103]="cs_queryPlayerByPos",e[e.fadeInPlayerPanel=104]="fadeInPlayerPanel",e[e.cs_fadeInPlayerPanel=105]="cs_fadeInPlayerPanel",e[e.fadeOutPlayerPanel=106]="fadeOutPlayerPanel",e[e.cs_fadeOutPlayerPanel=107]="cs_fadeOutPlayerPanel",e[e.movePlayerPanel=108]="movePlayerPanel",e[e.cs_movePlayerPanel=109]="cs_movePlayerPanel",e[e.straightScore3=110]="straightScore3",e[e.straightScore5=111]="straightScore5",e[e.initPanel=112]="initPanel",e[e.cs_fadeInActivityPanel=113]="cs_fadeInActivityPanel",e[e.fadeInActivityPanel=114]="fadeInActivityPanel",e[e.cs_fadeInNextActivity=115]="cs_fadeInNextActivity",e[e.fadeInNextActivity=116]="fadeInNextActivity",e[e.cs_fadeInActivityExGame=117]="cs_fadeInActivityExGame",e[e.fadeInActivityExGame=118]="fadeInActivityExGame",e[e.cs_fadeOutActivityPanel=119]="cs_fadeOutActivityPanel",e[e.fadeOutActivityPanel=120]="fadeOutActivityPanel",e[e.cs_startGame=121]="cs_startGame",e[e.cs_restartGame=122]="cs_restartGame",e[e.cs_fadeInRankPanel=123]="cs_fadeInRankPanel",e[e.fadeInRankPanel=124]="fadeInRankPanel",e[e.cs_fadeInNextRank=125]="cs_fadeInNextRank",e[e.fadeInNextRank=126]="fadeInNextRank",e[e.cs_setGameComing=127]="cs_setGameComing",e[e.setGameComing=128]="setGameComing",e[e.cs_fadeOutRankPanel=129]="cs_fadeOutRankPanel",e[e.fadeOutRankPanel=130]="fadeOutRankPanel",e[e.cs_fadeInCountDown=131]="cs_fadeInCountDown",e[e.fadeInCountDown=132]="fadeInCountDown",e[e.cs_fadeOutCountDown=133]="cs_fadeOutCountDown",e[e.fadeOutCountDown=134]="fadeOutCountDown",e[e.cs_inScreenScore=135]="cs_inScreenScore",e[e.inScreenScore=136]="inScreenScore",e[e.cs_fadeInFTShow=137]="cs_fadeInFTShow",e[e.fadeInFTShow=138]="fadeInFTShow",e[e.cs_fadeOutFTShow=139]="cs_fadeOutFTShow",e[e.fadeOutFTShow=140]="fadeOutFTShow",e[e.cs_fadeInPlayerRank=141]="cs_fadeInPlayerRank",e[e.fadeInPlayerRank=142]="fadeInPlayerRank",e[e.cs_fadeInFtRank=143]="cs_fadeInFtRank",e[e.fadeInFtRank=144]="fadeInFtRank",e[e.cs_fadeInMixRank=145]="cs_fadeInMixRank",e[e.fadeInMixRank=146]="fadeInMixRank",e[e.cs_findPlayerData=147]="cs_findPlayerData",e[e.cs_attack=148]="cs_attack",e[e.attack=149]="attack",e[e.cs_addHealth=150]="cs_addHealth",e[e.addHealth=151]="addHealth",e[e.fadeInOK=152]="fadeInOK",e[e.cs_combo=153]="cs_combo",e[e.combo=154]="combo"}(a||(a={})),t.CommandId={};for(var n in a)t.CommandId[n]=n},,,function(e,t){"use strict";function a(e){return function(t,a){return t[e]-a[e]}}function n(e){return function(t,a){return a[e]-t[e]}}function r(e,t,a){var n=[];for(var r in e)n.push(e[r]);return n.sort(a(t)),n}function i(e,t){var a=[];for(var n in e)a.push(e[n]);return t&&(a=JSON.parse(JSON.stringify(a))),a}function o(e,t){for(var a=0,n=0;n<t.length;n++){var r=t[n];e.indexOf(r)>-1&&a++}return a}function l(e,t,a){return t==a.indexOf(e)}function s(e,t){var a=new Image;a.onload=function(){t(a)},a.src=e}function c(e,t){function a(){i--,0===i&&(i=-1,t(n))}var n,r,i=e.length;i&&e[0].hasOwnProperty("name")&&e[0].hasOwnProperty("url")?(r=!1,n={}):(r=!0,n=[]);for(var o,l,s=0;s<e.length;s++){var c=e[s];o=new Image,r?(n.push(o),l=c):(n[c.name]=o,l=c.url),o.onload=a,o.src=l}}function d(e,t){var a=[];return function e(t,n,r){if(0==r)return a.push(t);for(var i=0,o=n.length;i<=o-r;i++)e(t.concat(n[i]),n.slice(i+1),r-1)}([],e,t),a}function h(e,t,a){void 0===t&&(t=":"),void 0===a&&(a="");var n=Math.floor(e/60),r=e%60,i=n+"",o=r+"";return n<10&&(i="0"+i),r<10&&(o="0"+o),i+t+o+a}function u(e){for(var t=0,a=e.length,n=-1,r=0;r<a;r++)n=e.charCodeAt(r),t+=n>=0&&n<=128?1:2;return t}function p(e,t,a){void 0===a&&(a=0);for(var n=0,r=e.length,i=new String,o="",l=a;l<r;l++){var s=e.charAt(l);n++,escape(s).length>4&&n++,i=i.concat(s),n>=t&&(o+=i.concat("\n"),i=new String,n=0)}return o+=i}t.ascendingProp=a,t.descendingProp=n,t.mapToSortArray=r,t.mapToArr=i,t.arrCountSame=o,t.arrUniqueFilter=l,t.loadImg=s,t.loadImgArr=c,t.combineArr=d,t.formatSecond=h,t.getLength=u,t.cnWrap=p,t.getUrlFilename=function(e){var t=e.split("/"),a=t[t.length-1];return a},t.DateFormat=function(e,t){var a={"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),S:e.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length)));for(var n in a)new RegExp("("+n+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?a[n]:("00"+a[n]).substr((""+a[n]).length)));return t}},,,function(e,t,a){"use strict";var n=this&&this.__extends||function(e,t){function a(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)},r=a(17),i=function(){function e(){this.id=0,this.name="",this.phone=0,this.eloScore=0,this.style=0,this.avatar="",this.height=0,this.weight=0,this.dtScore=0,this.activityId=0,this.gameRec=[],this.loseGameCount=0,this.winGameCount=0,this.ftId=0,this.ftScore=0,this.playerNum=0,this.curFtScore=0,this.location="上海"}return e}();t.PlayerDoc=i,t.PlayerState1v1={FIGHTING:" ",PIGEON:"鸽子",WAITING:"  ",Dead:"淘汰"};var o=function(e){function t(t){e.call(this),this.playerData=new i,this.isRed=!0,this.isMvp=!1,this.backNumber=0,t&&(null!=t.playerData?(this.playerData=r.obj2Class(t.playerData,i),this.setPlayerInfoFromData(t)):(this.playerData=r.obj2Class(t,i),this.setPlayerInfoFromData(t)))}return n(t,e),t.prototype.setPlayerInfoFromData=function(e){null!=e.isRed&&(this.isRed=e.isRed),null!=e.isMvp&&(this.isMvp=e.isMvp),null!=e.backNumber&&(this.backNumber=e.backNumber)},t.prototype.getPlayerData=function(){return this.playerData.isRed=this.isRed,this.playerData.isMvp=this.isMvp,this.playerData.backNumber=this.backNumber,this.playerData},t.prototype.id=function(e){return r.prop(this.playerData,"id",e)},t.prototype.phone=function(e){return r.prop(this.playerData,"phone",e)},t.prototype.name=function(e){return r.prop(this.playerData,"name",e)},t.prototype.activityId=function(e){return r.prop(this.playerData,"activityId",e)},t.prototype.eloScore=function(e){return r.prop(this.playerData,"eloScore",e)},t.prototype.dtScore=function(e){return r.prop(this.playerData,"dtScore",e)},t.prototype.style=function(e){return r.prop(this.playerData,"style",e)},t.prototype.avatar=function(e){return r.prop(this.playerData,"avatar",e)},t.prototype.gameRec=function(e){return r.prop(this.playerData,"gameRec",e)},t.winPercent=function(e){var a=e.winGameCount/t.gameCount(e);return a||(a=0),a},t.winPercentStr=function(e){return(100*t.winPercent(e)).toFixed(1)+"%"},t.weight=function(e){return e.weight||e.playerData.weight},t.height=function(e){return e.height||e.playerData.height},t.intro=function(e){return e.intro||e.playerData.intro},t.prototype.winpercent=function(e){return this.winGameCount()/this.gameCount()},t.gameCount=function(e){return e.loseGameCount+e.winGameCount||0},t.addWinGameAmount=function(e){return e.winGameCount++,e.winGameCount},t.addLoseGameAmount=function(e){return e.loseGameCount++,e.loseGameCount},t.prototype.gameCount=function(){return this.loseGameCount()+this.winGameCount()},t.prototype.winGameCount=function(e){return r.prop(this.playerData,"winGameCount",e)},t.prototype.loseGameCount=function(e){return r.prop(this.playerData,"loseGameCount",e)},t.prototype.getWinPercent=function(){return(100*this.winpercent()).toFixed(1)+"%"},t.getStyleIcon=function(e){var t="/img/panel/stage/";return 1===e?t+="feng.png":2===e?t+="lin.png":3===e?t+="huo.png":4===e&&(t+="shan.png"),t},t.prototype.getWinStyleIcon=function(){var e="/img/panel/stage/win/";return 1==this.style()?e+="fengWin.png":2==this.style()?e+="linWin.png":3==this.style()?e+="huoWin.png":4==this.style()&&(e+="shanWin.png"),e},t.prototype.getRec=function(){return{id:this.id(),eloScore:this.eloScore(),dtScore:this.dtScore()}},t.prototype.saveScore=function(e,t){this.dtScore(e),this.eloScore(this.eloScore()+e),t?this.winGameCount(this.winGameCount()+1):this.loseGameCount(this.loseGameCount()+1)},t.prototype.getCurWinningPercent=function(){return this.winGameCount()/(this.loseGameCount()+this.winGameCount())},t}(r.BaseInfo);t.PlayerInfo=o},function(e,t){"use strict";function a(e,t){for(var a in e)t.hasOwnProperty(a)&&(t[a]=e[a])}t.isdef=function(e){return void 0!=e},t.prop=function(e,a,n,r){return t.isdef(n)?(e[a]=n,void(r&&r())):e[a]},t.obj2Class=function(e,t){var a=new t;for(var n in e)a[n]=e[n];return a},t.setPropTo=a;var n=function(){function e(){}return e}();t.BaseDoc=n;var r=function(){function e(){}return e}();t.BaseInfo=r},,,,function(e,t,a){"use strict";var n,r=this&&this.__extends||function(e,t){function a(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)},i=a(22),o=a(32),l=a(4),s=a(13),c=a(8),d=a(10),h=function(e,t,a){$.post("/panel/"+c.PanelId.onlinePanel+"/"+e,t,a)},u=function(e){function t(){e.call(this),this.template=a(33),this.links=l.VueBase.PROP,this.isOp=l.VueBase.PROP,this.gameId=l.VueBase.PROP,this.panelTime=l.VueBase.String,this.liveTime=l.VueBase.String,this.delayTime=l.VueBase.Number,this.test=l.VueBase.PROP,this.srvTime=0,this.isTimerRunning=!1,this.delayTimeMS=0,this.methods={onClkSetDelay:function(){console.log("onClkSetDelay",this,this.delayTime);var e=Number(this.delayTime);e>=0&&(this.delayTimeMS=1e3*e,h(""+d.CommandId.cs_setDelayTime,{delayTimeMS:this.delayTimeMS,_:null},function(){}))},onClkStartTimer:function(){h(""+d.CommandId.cs_startTimer,{_:null},function(){console.log("onClkStartTimer")})},onClkPauseTimer:function(){h(""+d.CommandId.cs_pauseTimer,{_:null},function(){console.log("onClkPauseTimer")})},onClkResetTimer:function(){h(""+d.CommandId.cs_resetTimer,{_:null},function(){console.log("onClkResetTimer")})}},l.VueBase.initProps(this)}return r(t,e),t.prototype.created=function(){console.log("RKBView created!"),this.panelTime="tesst",this.isOp="op"==this.$route.params.op,this.isOp&&o.dynamicLoading.css("/css/bulma.min.css"),this.gameId=this.$route.params.game_id},t.prototype.mounted=function(){n||(n=new i.StageRKBView(this)),console.log("op mounted!")},t.prototype.onTick=function(){console.log("onTick"),this.srvTime+=1e3,this.liveTime=s.DateFormat(new Date(this.srvTime),"hh:mm:ss"),this.panelTime=s.DateFormat(new Date(this.srvTime-this.delayTimeMS),"hh:mm:ss")},t.prototype.setSrvTime=function(e){var t=this;console.log("isRunning:",this.isTimerRunning,this.onTick,e),this.srvTime=e,this.isTimerRunning||(this.isTimerRunning=!0,setInterval(function(){t.onTick()},1e3))},t}(l.VueBase);t.RKBView=u,t.rkbView=new u},function(e,t,a){"use strict";var n=this&&this.__extends||function(e,t){function a(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)},r=a(23),i=a(8),o=a(16),l=a(24),s=a(26),c=a(30),d=a(31),h=a(25),u=a(10),p=function(e){function t(t){e.call(this,i.PanelId.rkbPanel),this.delayTimeMS=0,this.initCanvas(),this.$opView=t,this.isScorePanelVisible=!0,this.scorePanel=new l.ScorePanel(this,!0),this.playerPanel=new s.PlayerPanel(this,!0),this.eventPanel=new c.EventPanel(this),this.countDownRender=new d.CountDownPanel(this.stage),console.log("StageRKBView router",this.$opView.$route.params,this.$opView.$route.query);this.$opView.$route.params.op;this.initOp(),this.initAuto()}return n(t,e),t.prototype.initOp=function(){var e=this,t=io.connect("http://"+window.location.host+"/"+i.PanelId.rkbPanel);t.on("connect",function(e){console.log("connect",window.location.host),t.emit("opUrl",{opUrl:window.location.host})}).on(""+u.CommandId.sc_setDelayTime,function(t){console.log("CommandId.setDelayTime",t),e.delayTimeMS=t.delayTimeMS}).on(u.CommandId.sc_startTimer,function(t){e.scorePanel.toggleTimer1(i.TimerState.RUNNING)}).on(u.CommandId.sc_pauseTimer,function(t){e.scorePanel.toggleTimer1(i.TimerState.PAUSE)}).on(u.CommandId.sc_resetTimer,function(t){console.log("CommandId.sc_resetTimer",t),e.scorePanel.resetTimer()})},t.prototype.initAuto=function(){var e=this,t=io.connect(hupuWsUrl),a=function(t,a){var n=new o.PlayerInfo,r=t;n.name(r.name),n.avatar(r.avatar),n.winGameCount(r.winAmount),n.loseGameCount(r.loseAmount),n.playerData.ftDoc={name:t.group},n.playerData.playerNum=t.playerNum,n.playerData.curFtScore=t.roundScore,e.playerPanel.setPlayer(0,n.playerData);var i=new o.PlayerInfo;r=a,i.name(r.name),i.avatar(r.avatar),i.winGameCount(r.winAmount),i.loseGameCount(r.loseAmount),i.playerData.ftDoc={name:a.group},i.playerData.playerNum=a.playerNum,i.playerData.curFtScore=a.roundScore,e.playerPanel.setPlayer(1,i.playerData),e.scorePanel.setPlayerName([t.name,a.name])};t.on("connect",function(){console.log("hupuAuto socket connected"),t.emit("passerbyking",{game_id:e.$opView.$route.params.game_id,page:"score"})}),t.on("wall",function(t){var n=t.et,r={};console.log("event:",n,t),r.init=function(){console.log("init",t,"visible",e.isScorePanelVisible),e.scorePanel.ctn.visible=e.isScorePanelVisible,e.scorePanel.set35ScoreLight(t.winScore),e.scorePanel.setGameIdx(t.gameIdx),a(t.player.left,t.player.right),e.scorePanel.setLeftScore(t.player.left.leftScore),e.scorePanel.setRightScore(t.player.right.rightScore),e.scorePanel.setLeftFoul(t.player.left.leftFoul),e.scorePanel.setRightFoul(t.player.right.rightFoul),0==t.status&&(e.scorePanel.resetTimer(),e.scorePanel.toggleTimer1(i.TimerState.RUNNING)),console.log("$opView",e.$opView),e.$opView.setSrvTime(t.t)},r.updateScore=function(){console.log("updateScore",t),null!=t.leftScore&&e.scorePanel.setLeftScore(t.leftScore),null!=t.rightScore&&e.scorePanel.setRightScore(t.rightScore),null!=t.rightFoul&&e.scorePanel.setRightFoul(t.rightFoul),null!=t.leftFoul&&e.scorePanel.setLeftFoul(t.leftFoul)},r.startGame=function(){console.log("startGame",t),e.scorePanel.set35ScoreLight(t.winScore),e.scorePanel.setGameIdx(t.gameIdx),a(t.player.left,t.player.right),e.scorePanel.resetScore(),e.scorePanel.resetTimer(),e.scorePanel.toggleTimer1(i.TimerState.RUNNING)},r.commitGame=function(){if(e.isScorePanelVisible){var a=0==t.idx;t.player.winGameCount=t.player.winAmount,t.player.loseGameCount=t.player.loseAmount,t.player.curFtScore=t.player.roundScore,e.eventPanel.playerInfoCard.fadeInWinPlayer(a,t.player),e.scorePanel.toggleTimer1(i.TimerState.PAUSE)}},r.fadeInCountDown=function(){var a=t.text,n=t.cdSec;t.type;e.countDownRender.fadeInCountDown(n,a),console.log("fadeInCountDown",t)},r.fadeOutCountDown=function(){e.countDownRender.fadeOut(),console.log("fadeOutCountDown",t)},r[n]&&h.delayCall(e.delayTimeMS,function(){r[n]()})})},t}(r.BasePanelView);t.StageRKBView=p},function(e,t,a){"use strict";var n=a(8),r=function(){function e(e){this.opReq=function(t,a,n){$.post("/panel/"+e+"/"+t,a,n)}}return e.initPixi=function(){var e=new PIXI.autoDetectRenderer(n.ViewConst.STAGE_WIDTH,n.ViewConst.STAGE_HEIGHT,{antialias:!1,transparent:!0,resolution:1});return document.body.insertBefore(e.view,document.getElementById("panel")),e.stage=new PIXI.Container,e.backgroundColor=0,e.renderStage=function(){requestAnimationFrame(e.renderStage),e.render(e.stage)},e.renderStage(),e.stage},e.initStage=function(){var e=document.getElementById("stage");if(e){e.setAttribute("width",n.ViewConst.STAGE_WIDTH+""),e.setAttribute("height",n.ViewConst.STAGE_HEIGHT+"");var t=new createjs.Stage(e);return t.autoClear=!0,createjs.Ticker.framerate=60,createjs.Ticker.addEventListener("tick",function(){t.update()}),console.log("initStage"),t}throw"no elem id; 'stage'"},e.prototype.initCanvas=function(){this.stageWidth=n.ViewConst.STAGE_WIDTH,this.stageHeight=n.ViewConst.STAGE_HEIGHT;var e=document.getElementById("stage");if(e){e.setAttribute("width",this.stageWidth+""),e.setAttribute("height",this.stageHeight+"");var t=new createjs.Stage(e);t.autoClear=!0,createjs.Ticker.framerate=60,createjs.Ticker.addEventListener("tick",function(){t.update()}),this.ctn=new createjs.Container,t.addChild(this.ctn),this.stage=t,console.log("initCanvas")}},e.prototype.show=function(){},e.prototype.hide=function(){},e}();t.BasePanelView=r},function(e,t,a){"use strict";var n=createjs.Ease,r=createjs.Tween,i=a(25),o=a(8),l=a(13),s=function(){function e(e,t){void 0===t&&(t=!1),this.timeOnSec=0;var a=new createjs.Container;this.ctn=a,a.y=e.stageHeight-132,e.stage.addChild(a);var n;n=new createjs.Bitmap("/img/panel/stage1v1/scoreBg1v1.png"),a.addChild(n);var r=new createjs.Text("99:99","28px Arial","#fff");r.x=.5*e.stageWidth-31,r.y=100,this.timeText=r,a.addChild(r);var i=new createjs.SpriteSheet({animations:{0:1,1:2,2:3,3:4,4:5,5:6,6:7,7:8,8:9,9:0},images:["/img/panel/stage1v1/scoreNum.png"],frames:[[0,0,40,54],[41,0,40,54],[0,55,40,54],[41,55,40,54],[82,0,40,54],[82,55,40,54],[123,0,40,54],[123,55,40,54],[0,110,40,54],[41,110,40,54]]}),o=865,l=new createjs.BitmapText("0",i);l.letterSpacing=-2,l.x=o,l.y=60,this.leftScoreText=l,this.leftScoreTextX=l.x,a.addChild(l);var s=new createjs.BitmapText("0",i);s.letterSpacing=-2,s.x=o+160,s.y=l.y,this.rightScoreText=s,this.rightScoreTextX=s.x,a.addChild(s),this.leftCircleArr=[],this.rightCircleArr=[],this.leftCircleBgArr=[],this.rightCircleBgArr=[],this.set35ScoreLight(2),this.initFoulCircle(),o=770;var c=new createjs.Text("第x场","23px Arial","#fff");c.textAlign="center",c.x=964,c.y=59,a.addChild(c),this.gameThText=c}return e.prototype.initFoulCircle=function(){var e;this.leftFoulCircleArr=[],this.rightFoulCircleArr=[];for(var t=0;t<4;t++)e=new createjs.Bitmap("/img/panel/stage1v1/foul.png"),e.x=604+9*t,e.y=120-15*t,e.alpha=0,this.ctn.addChild(e),this.leftFoulCircleArr.push(e),e=new createjs.Bitmap("/img/panel/stage1v1/foul.png"),e.x=1318-9*t,e.scaleX=-1,e.y=120-15*t,e.alpha=0,this.ctn.addChild(e),this.rightFoulCircleArr.push(e);this.leftFoulHint=new createjs.Bitmap("/img/panel/stage1v1/foulHint.png"),this.leftFoulHint.x=590,this.leftFoulHint.y=62,this.ctn.addChild(this.leftFoulHint),this.rightFoulHint=new createjs.Bitmap("/img/panel/stage1v1/foulHint.png"),this.rightFoulHint.scaleX=-1,this.rightFoulHint.x=1332,this.rightFoulHint.y=62,this.ctn.addChild(this.rightFoulHint),this.rightFoulHint.alpha=this.leftFoulHint.alpha=0},Object.defineProperty(e.prototype,"isBlueWin",{get:function(){return Number(this.leftScoreText.text)>Number(this.rightScoreText.text)},enumerable:!0,configurable:!0}),e.prototype.setLeftFoul=function(e){this._setFoul(e,this.leftFoulCircleArr,this.leftFoulHint)},e.prototype._setFoul=function(e,t,a){e=Number(e),e>4&&(e=4);for(var o=0;o<t.length;o++)o<e?0==t[o].alpha&&i.blink(t[o]):createjs.Tween.get(t[o]).to({alpha:0},200);e>3?createjs.Tween.get(a,{loop:!0}).to({alpha:1},150,n.circIn).to({alpha:0},150,n.circOut):r.get(a,{loop:!1},null,!0).to({alpha:0})},e.prototype.setRightFoul=function(e){this._setFoul(e,this.rightFoulCircleArr,this.rightFoulHint)},e.prototype.setLeftScore=function(e){this.leftScoreText.text=e+"",e>9?this.leftScoreText.x=this.leftScoreTextX-18:this.leftScoreText.x=this.leftScoreTextX;for(var t=(this.leftCircleArr.length,0);t<this.leftCircleArr.length;t++)t<e?0==this.leftCircleArr[t].alpha&&i.blink(this.leftCircleArr[t]):createjs.Tween.get(this.leftCircleArr[t]).to({alpha:0},200)},e.prototype.setRightScore=function(e){e>9?this.rightScoreText.x=this.rightScoreTextX-18:this.rightScoreText.x=this.rightScoreTextX,this.rightScoreText.text=e+"";for(var t=this.rightCircleArr.length,a=0;a<t;a++)a<e?0==this.rightCircleArr[a].alpha&&i.blink(this.rightCircleArr[a]):createjs.Tween.get(this.rightCircleArr[a]).to({alpha:0},200)},e.prototype.set35ScoreLight=function(e){for(var t=0;t<this.rightCircleArr.length;t++){var a=this.rightCircleArr[t];a.parent.removeChild(a)}this.rightCircleArr.length=0;for(var t=0;t<this.rightCircleBgArr.length;t++){var a=this.rightCircleBgArr[t];a.parent.removeChild(a)}this.rightCircleBgArr.length=0;for(var t=0;t<this.leftCircleArr.length;t++){var a=this.leftCircleArr[t];a.parent.removeChild(a)}this.leftCircleArr.length=0;for(var t=0;t<this.leftCircleBgArr.length;t++){var a=this.leftCircleBgArr[t];a.parent.removeChild(a)}this.leftCircleBgArr.length=0;var n,r,i,o,l=this.ctn,s=88,c="stage1v1/mini";3==e?(r=780,i=1110,o=45):5==e?(r=780,i=1110,o=27):2==e&&(o=80,r=750,i=1090,c="stage1v1"),n=r;for(var t=0;t<e;t++){var d=new createjs.Bitmap("/img/panel/"+c+"/leftScoreBg.png");d.x=n-t*o,d.y=s,l.addChild(d),this.leftCircleBgArr.push(d);var h=new createjs.Bitmap("/img/panel/"+c+"/leftScore.png");h.x=d.x,h.y=d.y,l.addChild(h),this.leftCircleArr.push(h)}n=i;for(var t=0;t<e;t++){var u=new createjs.Bitmap("/img/panel/"+c+"/rightScoreBg.png");u.x=n+t*o,u.y=s,l.addChild(u),this.rightCircleBgArr.push(u);var p=new createjs.Bitmap("/img/panel/"+c+"/rightScore.png");p.x=u.x,p.y=u.y,l.addChild(p),this.rightCircleArr.push(p)}this.setLeftScore(Number(this.leftScoreText.text)),this.setRightScore(Number(this.rightScoreText.text))},e.prototype.getRec=function(){return{left:{score:Number(this.leftScoreText.text),name:this._playerName[0]},right:{score:Number(this.rightScoreText.text),name:this._playerName[1]}}},e.prototype.setAvgEloScore=function(e){},e.prototype.resetScore=function(){this.setLeftScore(0),this.setRightScore(0),this.setLeftFoul(0),this.setRightFoul(0)},e.prototype.resetTimer=function(){this.timeOnSec=0,this.timerState=o.TimerState.PAUSE,this.timeText.text=l.formatSecond(this.timeOnSec)},e.prototype.toggleTimer1=function(e){var t=this,a=function(){t.timerId&&(clearInterval(t.timerId),t.timerId=0,t.timerState=o.TimerState.PAUSE)},n=function(){t.timerId&&clearInterval(t.timerId),t.timerId=setInterval(function(){t.timeOnSec++,t.timeText.text=l.formatSecond(t.timeOnSec)},1e3),t.timerState=o.TimerState.RUNNING};null!=e?e==o.TimerState.PAUSE?a():e==o.TimerState.RUNNING&&n():this.timerId?a():n()},e.prototype.setTime=function(e,t){this.timeText.text=l.formatSecond(e),this.timeOnSec=e,t&&this.toggleTimer1()},e.prototype.setGameIdx=function(e){null==e&&(e=0),this.gameThText.text="第"+e+"场"},e.prototype.init=function(e){this.setLeftScore(e.leftScore),this.setRightScore(e.rightScore),this.setLeftFoul(e.leftFoul),this.setRightFoul(e.rightFoul),this.setGameIdx(e.gameTh)},e.prototype.setPlayerName=function(e){this._playerName=e},e}();t.ScorePanel=s},function(e,t){"use strict";function a(e,t){createjs.Tween.get(this).wait(e).call(t)}function n(e,t,a){void 0===t&&(t=80),void 0===a&&(a=!1);var n=t;createjs.Tween.get(e,{loop:a}).to({alpha:1},n).to({alpha:0},n).to({alpha:1},n).to({alpha:0},n).to({alpha:1},n)}function r(e,t,a){function n(a){e.visible&&TweenLite.to(e,t,{alpha:a}).eventCallback("onComplete",function(){n(a?0:1)})}void 0===t&&(t=.008),void 0===a&&(a=!1),n(1)}function i(e){console.log(this,"show fade Out WinPanel"),createjs.Tween.get(e).to({alpha:0},200).call(function(){e.alpha=1,e.removeAllChildren()})}t.delayCall=a,t.blink=n,t.blink2=r,t.fadeOutCtn=i},function(e,t,a){"use strict";var n=a(16),r=a(27),i=function(){function e(e,t){void 0===t&&(t=!1),this.playerCardArr=[];for(var a=e.scorePanel.ctn,i=new n.PlayerInfo,o=25,l=40,s=150,c=0;c<1;c++){var d=new r.StagePlayerCard(i,1,!0,!0);d.delayShow(600*c),d.x=o+c*s,d.y=l,this.playerCardArr.push(d),a.addChild(d),t&&(d.x+=450)}o=1249;for(var c=0;c<1;c++){var d=new r.StagePlayerCard(i,1,!1,!0);d.delayShow(600*(3-c)),d.x=o+c*s,d.y=l,this.playerCardArr.push(d),a.addChild(d)}}return e.prototype.setEloScore=function(e,t){this.playerCardArr[e].setEloScore(t)},e.prototype.setPlayer=function(e,t,a){void 0===a&&(a=!1);var n=this.playerCardArr[e];n.setPlayerInfo(t,1,n.isBlue)},e.prototype.init=function(e){for(var t=0;t<e.playerInfoArr.length;t++)if(e.playerInfoArr[t]){var a=new n.PlayerInfo(e.playerInfoArr[t]);this.setPlayer(t,a.playerData),a.id()==e.kingPlayer}},e}();t.PlayerPanel=i},function(e,t,a){"use strict";var n=this&&this.__extends||function(e,t){function a(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)},r=createjs.Text,i=createjs.Container,o=a(25),l=a(28),s=function(e){function t(t,a,n,r){void 0===a&&(a=1),void 0===n&&(n=!0),void 0===r&&(r=!1),e.call(this),this._delayShowEnd=!1,this.playerInfo=t,this.isDelayShow=r,this.setPlayerInfo(t.playerData,a,n)}return n(t,e),t.prototype.setName=function(e){this.nameText.text=e},t.prototype.setEloScore=function(e){this.eloScoreText.text=e.toString()},t.prototype.setBackNumber=function(e){this.backNumText.text=e},t.prototype.setStyle=function(e){},t.prototype.setKingLabel=function(){},t.prototype.setPlayerInfo=function(e,t,a){var n=this;void 0===t&&(t=1),
void 0===a&&(a=!0),this.isBlue=a;var i=this;this.removeAllChildren();var s=20,c=new createjs.Container;this.avatarCtn=c,a?c.x=20-s:c.x=-2+s;var d=new createjs.Shape,h=48,u=81,p=145;a?(d.x=16,d.graphics.beginFill("#000").moveTo(h,0).lineTo(0,u).lineTo(p-h,u).lineTo(p,0).lineTo(h,0)):(d.x=19,d.graphics.beginFill("#000").moveTo(0,0).lineTo(h,u).lineTo(p,u).lineTo(p-h,0).lineTo(0,0));var f;f=a?"/img/panel/stage1v1/blue.png":"/img/panel/stage1v1/red.png",f=e.avatar||f,l.loadAutoAvatarShape(f,function(e){e.mask=d,c.addChild(d),c.addChild(e),n.avatarBmp=e,n.isDelayShow&&(n._delayShowEnd?o.blink(e):e.alpha=0),e.scaleX=e.scaleY=u/e.height}),i.addChildAt(c,0);var g=new createjs.Text(e.winGameCount+"胜 "+e.loseGameCount+"负  贡献值:"+e.curFtScore,"16px Arial","#fff");g.y=-2,this.eloScoreText=g,a?(g.textAlign="right",g.x=344):g.x=-142,i.addChild(g);var m=new createjs.Text(e.name,"bold 24px Arial","#fff");this.nameText=m,m.y=5,a?(m.textAlign="right",m.x=58-s):m.x=137+s,i.addChild(m);var y=new createjs.Text(e.playerNum?e.playerNum+"":"99","bold 26px Arial","#c3b7dd");this.playerNumText=y,y.textAlign="center",y.y=55,a?y.x=-153:y.x=353,i.addChild(y);var v=e.ftDoc;console.log("playerDoc",e);var w="所属战团：";w+=v?v.name:"无";var x=new r(w,"16px Arial","#fff");return x.y=40,a?(x.textAlign="right",x.x=40-s):x.x=160+s,i.addChild(x),i},t.prototype.delayShow=function(e){var t=this;console.log("delay show",e),this._delayShowEnd=!1,createjs.Tween.get(this.avatarCtn).wait(e).call(function(){t._delayShowEnd=!0,t.avatarBmp&&o.blink(t.avatarBmp)}),o.delayCall(e,function(){t.avatarBmp&&(t.avatarBmp.alpha=0)})},t.newScoreText=function(){var e=new createjs.SpriteSheet({animations:{0:1,1:2,2:3,3:4,4:5,5:6,6:7,7:8,8:9,9:0},images:["/img/panel/stage1v1/scoreNum.png"],frames:[[0,0,40,54],[41,0,40,54],[0,55,40,54],[41,55,40,54],[82,0,40,54],[82,55,40,54],[123,0,40,54],[123,55,40,54],[0,110,40,54],[41,110,40,54]]});return new createjs.BitmapText("0",e)},t}(i);t.StagePlayerCard=s},function(e,t,a){"use strict";var n=createjs.Container,r=a(16),i=a(29),o=a(13),l=a(8),s=a(25),c=createjs.Text,d=createjs.Bitmap,h=a(!function(){var e=new Error('Cannot find module "jquery"');throw e.code="MODULE_NOT_FOUND",e}()),u=function(){function e(e){this.ctn=new createjs.Container,e.addChild(this.ctn)}return e.prototype.fadeInfoPlayerInfoCard=function(e){this.ctn.removeAllChildren(),h("#ex").html(""),this.ctn.addChild(i.CreateJsEx.newModal());for(var t=0;t<e.length;t++){var a,n=e[t],o=t<1;a=new r.PlayerInfo(n),a.isBlue=o,a.isKing=n.isKing;var l=this.getWinPlayerCard(a,function(e){var t=e.playerCard.getBounds();t&&e.playerCard.cache(t.x,t.y,t.width,t.height)});a.playerCard=l,l.x=830*t+400,l.y=250,l.px=l.x,l.py=l.y,l.x=500,l.scaleX=l.scaleY=.01,createjs.Tween.get(l).to({x:l.px,scaleX:1.1,scaleY:1.1},200).to({scaleX:1,scaleY:1},60).call(function(){h(".BlueIntro").show(),h(".RedIntro").show()}),this.ctn.addChild(l)}},e.prototype.getWinPlayerCard=function(e,t){var a=new createjs.Container;console.log("playerCard=======:",e.avatar());var n="/img/panel/stage1v1/win/playerBgWin";return n+=e.isBlue?"Blue":"Red",n+=".png",console.log("bg Path:",n),o.loadImgArr([e.avatar(),n],function(n){var i=n[0],o=n[1],l=e.final,s=new createjs.Bitmap(e.avatar()),c=80/s.getBounds().height;s.scaleX=s.scaleY=1.2*c,s.x=42,s.y=80,l&&(s.scaleX=s.scaleY=100/s.getBounds().height,s.x=45,s.y=79),s.sourceRect=new createjs.Rectangle((i.width-180)/2,(i.height-76)/2,180,76),s.scaleX=s.scaleY=1.2,a.addChild(s);var d=new createjs.Bitmap(o);d.x=-116,d.y=-80,l&&(d.x=-132,d.y=-105),a.addChild(d);var u;u=e.isBlue?"#1ac3fa":"#e23f6b";var p,f="#ddd";p=new createjs.Text(e.name(),"bold 30px Arial",u),p.textAlign="center",p.x=150,p.y=200,l&&(p.x+=20,p.y=215),a.addChild(p);var g;g=new createjs.Text("身高："+r.PlayerInfo.height(e)+" cm  体重："+r.PlayerInfo.weight(e)+" kg","18px Arial",f),g.textAlign="center",g.x=p.x,g.y=275,l&&(g.y+=15),a.addChild(g),e.isBlue?h("#ex").append('<textarea class="PlayerIntro BlueIntro" >'+r.PlayerInfo.intro(e)+"</textarea>"):h("#ex").append('<textarea class="PlayerIntro RedIntro"  >'+r.PlayerInfo.intro(e)+"</textarea>");var m=new createjs.Text(e.winGameCount()+"胜 / "+e.loseGameCount()+"负 贡献值:"+e.playerData.curFtScore,"25px Arial","#f1c236");m.textAlign="center",m.x=p.x,m.y=410,l&&(m.x+=5,m.y+=48),a.addChild(m),t(e)}),a},e.ftOpenPlayerCard=function(e){var t=new n,a=new d("/img/panel/stage1v1/ft/ftPlayerCard.png");t.addChild(a),o.loadImg(e.avatar,function(){var a=new d(e.avatar),n=104/a.getBounds().height;a.scaleY=a.scaleX=n,a.x=46,a.alpha=.7,a.y=62,t.addChildAt(a,0)});var r,i=170,l="#f1c236";r=new c(e.name,"bold 30px Arial",l),r.textAlign="center",r.x=i,r.y=191,t.addChild(r);var s;s=new c((e.ftScore?e.ftScore:0)+"分","bold 30px Arial","#fff"),s.textAlign="center",s.x=i,s.y=240,t.addChild(s);var h;h=new c(e.location?e.location:"上海","18px Arial","#fff"),h.textAlign="center",h.x=i,h.y=305,t.addChild(h);var u=new c("身高："+e.height+" cm","18px Arial","#fff");u.x=35,u.y=343,t.addChild(u);var p=new c("体重："+e.weight+" kg","18px Arial","#fff");p.x=195,p.y=u.y,t.addChild(p);var f=new c(o.cnWrap(e.intro,24),"22px Arial","#fff");return f.x=30,f.lineHeight=26,f.y=382,t.addChild(f),t},e.prototype.fadeOutPlayerInfoCard=function(){h(".BlueIntro").hide(),h(".RedIntro").hide(),s.fadeOutCtn(this.ctn)},e.prototype.fadeInWinPlayer=function(e,t){var a=this;this.ctn.removeAllChildren();var n=this.ctn;h("#ex").html(""),n.addChild(i.CreateJsEx.newModal());var s="/img/panel/stage1v1/win/winPanelTitle";s+=e?"Blue.png":"Red.png";var c=new createjs.Container;o.loadImg(s,function(){var e=new createjs.Bitmap(s);e.x=-419,e.y=-158,c.x=.5*l.ViewConst.STAGE_WIDTH,c.y=170,c.scaleX=c.scaleY=5,c.alpha=0,createjs.Tween.get(c).to({scaleX:1,scaleY:1,alpha:1},150),c.addChildAt(e,0)}),n.addChild(c);var d=new r.PlayerInfo(t);d.isBlue=e;var u=this.getWinPlayerCard(d,function(e){var t=e.playerCard.getBounds();t&&e.playerCard.cache(t.x,t.y,t.width,t.height)});d.playerCard=u,u.x=800,u.y=250,u.px=u.x,u.py=u.y,u.x=500,u.scaleX=u.scaleY=.01,createjs.Tween.get(u).to({x:u.px,scaleX:1.1,scaleY:1.1},200).to({scaleX:1,scaleY:1},60).call(function(){var e=h(".PlayerIntro").css({left:"835px"});e.show()}),n.addChild(u),createjs.Tween.get(u).wait(5e3).call(function(){a.fadeOutWinPlayer()})},e.prototype.fadeOutWinPlayer=function(){h(".PlayerIntro").hide(),s.fadeOutCtn(this.ctn)},e}();t.PlayerInfoCard=u,t.loadAutoAvatarShape=function(e,t){var a=new createjs.Shape,n=new Image;n.onload=function(){if(console.log("img1",n.height,n.width),n.width>=180&&n.height>=76){var e=new createjs.Matrix2D;e.tx=-(n.width-180)/2,e.ty=-(n.height-76)/2,a.graphics.beginBitmapFill(n,null,e),a.graphics.drawRect(0,0,180,76)}else a.graphics.beginBitmapFill(n),a.graphics.drawRect(0,0,180,76);t(a)},n.src=e}},function(e,t,a){"use strict";var n=a(8),r=function(){function e(){}return e.newBtn=function(e,t){var a=new createjs.Container,n=new createjs.Shape,r=75,i=30;if(n.graphics.beginFill("#3c3c3c").drawRect(0,0,r,i),n.addEventListener("click",e),a.addChild(n),t){var o=new createjs.Text(t,"18px Arial","#e2e2e2");o.x=.3*(r-o.getMeasuredWidth()),o.y=.3*(i-o.getMeasuredHeight())-5,o.mouseEnabled=!1,a.addChild(o)}return a},e.newModal=function(e){void 0===e&&(e=.3);var t=new createjs.Shape;return t.graphics.beginFill("#000").drawRect(0,0,n.ViewConst.STAGE_WIDTH,n.ViewConst.STAGE_HEIGHT),t.alpha=e,t},e}();t.CreateJsEx=r},function(e,t,a){"use strict";var n=a(16),r=a(29),i=a(28),o=createjs.Container,l=createjs.Text,s=createjs.Bitmap,c=createjs.Ease,d=createjs.Shape,h=a(13),u=function(){function e(e){this.curPage=0;var t=new createjs.Container;e.stage.addChild(t),this.ctn=t,this.playerInfoCard=new i.PlayerInfoCard(e.stage)}return e.prototype.fadeInActPanel=function(e,t,a,i){var o=this;this.curPage+=a,this.itemArr=[],this.titleItemArr=[],this.ctn.removeAllChildren(),this.ctn.addChild(r.CreateJsEx.newModal());var l=function(e){var a=new createjs.Container,l=new createjs.Bitmap("/img/panel/stage1v1/actTitle.png");o.titleItemArr.push(l),a.addChild(l);for(var s=0;s<10;s++){var c=e[s];if(c){var d=new createjs.Container;o.itemArr.push(d),d.y=95*s+95,c.state&&c.state!=n.PlayerState1v1.FIGHTING||(c.state=n.PlayerState1v1.WAITING);var h,u=c.state;u==n.PlayerState1v1.FIGHTING?h=new createjs.Bitmap("/img/panel/stage1v1/fighting.png"):u==n.PlayerState1v1.WAITING?h=new createjs.Bitmap("/img/panel/stage1v1/waiting.png"):u==n.PlayerState1v1.Dead?h=new createjs.Bitmap("/img/panel/stage1v1/dead.png"):u==n.PlayerState1v1.PIGEON&&(h=new createjs.Bitmap("/img/panel/stage1v1/pigeon.png")),h.name="bg",d.playerDoc=c,d.addChild(h),a.addChild(d);var p=new createjs.Bitmap(c.avatar);if(p.x=10,p.y=10,p.getBounds()){var f=70/p.getBounds().height;p.scaleX=p.scaleY=f}d.addChild(p);var g=new createjs.Text(c.name,"28px Arial","#fff");g.textAlign="center",g.x=300,g.y=30,d.addChild(g);var m=new createjs.Text(c.winGameCount+"/"+c.loseGameCount,"32px Arial","#fff");m.textAlign="center",m.x=495,m.y=g.y,d.addChild(m);var y=new createjs.Text(u,"28px Arial","#fff");if(y.name="stateText",y.textAlign="left",y.x=675,y.y=g.y,d.addChild(y),t){var v=r.CreateJsEx.newBtn(function(e){},c.id+"");v.x=180,v.y=15,d.addChild(v);var w=r.CreateJsEx.newBtn(function(e){var t=e.target.parent.parent;t.playerDoc.state=n.PlayerState1v1.FIGHTING,i(t.playerDoc)},"战斗");w.x=420,w.y=15,d.addChild(w);var x=r.CreateJsEx.newBtn(function(e){var t=e.target.parent.parent;t.playerDoc.state=n.PlayerState1v1.WAITING,i(t.playerDoc)},"等待");x.x=500,x.y=15,d.addChild(x);var C=r.CreateJsEx.newBtn(function(e){var t=e.target.parent.parent;t.playerDoc.state=n.PlayerState1v1.Dead,i(t.playerDoc)},"淘汰");C.x=580,C.y=15,d.addChild(C);var P=r.CreateJsEx.newBtn(function(e){var t=e.target.parent.parent;t.playerDoc.state=n.PlayerState1v1.PIGEON,i(t.playerDoc)},"鸽子");P.x=660,P.y=w.y,d.addChild(P)}}}return a},s=l(e.slice(10*this.curPage,10*(this.curPage+1)));s.x=120,s.y=10;var c=l(e.slice(10*(this.curPage+1),10*(this.curPage+2)));c.x=1030,c.y=s.y,this.ctn.addChild(s),this.ctn.addChild(c)},e.prototype.updatePlayerState=function(e){console.log("updatePlayerState",e);for(var t=0;t<this.itemArr.length;t++){var a=this.itemArr[t];if(a.playerDoc.id==e.id){a.playerDoc.state=e.state,e.state==n.PlayerState1v1.Dead?(a.getChildByName("bg").image.src="/img/panel/stage1v1/dead.png",a.getChildByName("stateText").text=a.playerDoc.state):e.state==n.PlayerState1v1.PIGEON?(a.getChildByName("bg").image.src="/img/panel/stage1v1/pigeon.png",a.getChildByName("stateText").text=a.playerDoc.state):e.state==n.PlayerState1v1.WAITING?(a.getChildByName("bg").image.src="/img/panel/stage1v1/waiting.png",a.getChildByName("stateText").text=a.playerDoc.state):e.state==n.PlayerState1v1.FIGHTING&&(a.getChildByName("bg").image.src="/img/panel/stage1v1/fighting.png",a.getChildByName("stateText").text=a.playerDoc.state);break}}},e.prototype.getWinPlayerCard=function(e,t){var a=e.isMvp,n=new createjs.Container;return console.log("playerCard=======:",e.avatar()),h.loadImg(e.avatar(),function(){var r=new createjs.Bitmap(e.avatar()),i=80/r.getBounds().height;a?(r.scaleX=r.scaleY=1.5*i,r.x=42,r.y=75):(r.scaleX=r.scaleY=1.2*i,r.x=42,r.y=80),n.addChild(r);var o="/img/panel/stage/win/playerBgWin";o+=e.isBlue?"Blue":"Red",o+=".png";var l=new createjs.Bitmap(o);e.isMvp?(l.x=-132,l.y=-105):(l.x=-116,l.y=-80),n.addChild(l);var s;s=e.isRed?"#e23f6b":"#1ac3fa";var c="#ddd";a&&(c="#f1c236");var d;d=a?new createjs.Text(e.name(),"30px Arial",c):new createjs.Text(e.name(),"30px Arial",s),d.textAlign="center",d.x=150,d.y=200,a&&(d.x+=20,d.y=215),n.addChild(d);var h,u="新秀";e.gameCount()>=3&&(u=e.eloScore()),h=new createjs.Text(u,"bold 32px Arial",c),h.textAlign="center",h.x=d.x,h.y=275,a&&(h.y+=30),n.addChild(h);var p=new createjs.Text("+"+e.dtScore(),"12px Arial",s);p.textAlign="left",p.x=200,p.y=290,a&&(p.x+=30,p.y+=30),n.addChild(p);var f=new createjs.Text("胜率"+e.getWinPercent(),"18px Arial",s);f.textAlign="center",f.x=d.x,f.y=320,a&&(f.y+=35),n.addChild(f);var g=new createjs.Text("场数"+e.gameCount(),"18px Arial",s);g.textAlign="center",g.x=d.x,g.y=350,a&&(g.y+=35),n.addChild(g);var m=new createjs.Bitmap(e.getWinStyleIcon());m.x=110,m.y=370,a&&(m.x+=20,m.y+=45),n.addChild(m),t(e.isMvp)}),n},e.prototype.fadeOutWinPanel=function(){console.log(this,"show fade Out WinPanel");for(var e=0;e<this.titleItemArr.length;e++){var t=this.titleItemArr[e];e<1?createjs.Tween.get(t).wait(80*e).to({x:-920},150,c.elasticIn):createjs.Tween.get(t).wait(80*(e-1)).to({x:1920},150,c.elasticIn)}for(var e=0;e<this.itemArr.length;e++){var a=this.itemArr[e];e<10?createjs.Tween.get(a).wait(80*(e+2)).to({x:-920},150,c.elasticIn):createjs.Tween.get(a).wait(80*(e-10+2)).to({x:1920},150,c.elasticIn)}var n=this.ctn;createjs.Tween.get(n).wait(80*(e-10)).to({alpha:0},100).call(function(){n.alpha=1,n.removeAllChildren()})},e.prototype.commonFadeOut=function(){var e=this.ctn;createjs.Tween.get(e).to({alpha:0},100).call(function(){e.alpha=1,e.removeAllChildren()})},e.prototype.fadeOutFtShow=function(){this.commonFadeOut()},e.prototype.fadeInMixRank=function(e){this.ctn.removeAllChildren();var t=new s("/img/panel/stage1v1/ft/ftRankBg2.jpg");this.ctn.addChild(t);for(var a=0;a<5;a++){var n=this.getPlayerItem(e.totalPlayerDocArr[a],e.ftMap,0==a||1==a?a+1:null);if(n.x=45,n.y=140+185*a,this.ctn.addChild(n),e.totalFtDocArr[a]){var r=this.getFtItem(e.totalFtDocArr[a],0==a||1==a?a+1:null);r.x=1005,r.y=n.y,this.ctn.addChild(r)}}},e.prototype.getFtItem=function(e,t){var a=new o,n=new s("/img/panel/stage1v1/ft/ftRankTeam.jpg");a.addChild(n);var r=new s(e.logo);if(r.x=18,r.y=18,a.addChild(r),t){var i=new s("/img/panel/stage1v1/ft/rank"+t+".png");i.x=-20,i.y=-30,a.addChild(i)}var c=new l(e.name,"bold 40px Arial","#fff");c.x=160,c.y=40,a.addChild(c);var d=new l(e.fullName+"","22px Arial","#fff");d.x=160,d.y=90,a.addChild(d);var h=new l((e.curScore?e.curScore:0)+"","22px Arial","#fff");h.textAlign="right",h.x=620,h.y=95,a.addChild(h);var u=new l((e.score?e.score:0)+"","22px Arial","#fff");return u.textAlign="right",u.x=780,u.y=95,a.addChild(u),a},e.prototype.fadeInFtRank=function(e){this.ctn.removeAllChildren();var t=new s("/img/panel/stage1v1/ft/ftRankBg.jpg");this.ctn.addChild(t);for(var a=0;a<e.curFtDocArr.length;a++){var n=this.getFtItem(e.curFtDocArr[a]);n.x=45,n.y=140+185*a,this.ctn.addChild(n);var r=this.getFtItem(e.totalFtDocArr[a]);r.x=1005,r.y=n.y,this.ctn.addChild(r)}},e.prototype.getPlayerItem=function(e,t,a){var n=new o,r=new s("/img/panel/stage1v1/ft/ftRankPlayer.jpg");n.addChild(r);var i=new o;if(n.addChild(i),h.loadImg(e.avatar,function(t){var a=new s(e.avatar);a.y=18,console.log("aw ",t.width),a.scaleX=a.scaleY=119/t.height,console.log("aw ",t.width),a.x=18+(130-t.width*a.scaleX)/2,i.addChild(a);var n=new d;n.graphics.beginFill("#000").dr(0,0,130,130),n.x=n.y=18,a.mask=n}),a){var c=new s("/img/panel/stage1v1/ft/rank"+a+".png");c.x=-20,c.y=-30,n.addChild(c)}var u=new l(e.name,"bold 40px Arial","#fff");u.x=160,u.y=40,n.addChild(u);var p;if(e.ftName)p=e.ftName;else{var f=t[e.ftId];p=f?f.name:"无"}var g=new l(p,"22px Arial","#fff");g.x=268,g.y=95,n.addChild(g);var m=new l((e.curFtScore?e.curFtScore:0)+"","22px Arial","#fff");m.textAlign="right",m.x=620,m.y=95,n.addChild(m);var y=new l((e.ftScore?e.ftScore:0)+"","22px Arial","#fff");return y.textAlign="right",y.x=780,y.y=95,n.addChild(y),n},e.prototype.fadeInPlayerRank=function(e){this.ctn.removeAllChildren();var t=new s("/img/panel/stage1v1/ft/ftRankBg.jpg");this.ctn.addChild(t);for(var a=0;a<5;a++){var n=this.getPlayerItem(e.curPlayerDocArr[a],e.ftMap,0==a||1==a?a+1:null);n.x=45,n.y=140+185*a,this.ctn.addChild(n);var r=this.getPlayerItem(e.totalPlayerDocArr[a],e.ftMap,0==a||1==a?a+1:null);r.x=1005,r.y=n.y,this.ctn.addChild(r)}},e}();t.EventPanel=u},function(e,t,a){"use strict";var n=createjs.Container,r=a(8),i=a(13),o=function(){function e(e){this.ctn=new n,e.addChild(this.ctn)}return e.prototype.fadeInCountDown=function(e,t){var a=this;this.ctn.removeAllChildren(),this.ctn.alpha=0,this.cdSec=e;var n=new createjs.Container;n.x=r.ViewConst.STAGE_WIDTH-479,n.y=r.ViewConst.STAGE_HEIGHT-200;var o=new createjs.Bitmap("/img/panel/act/countDownBg.png");n.addChild(o);var l=new createjs.Text("","40px Arial","#fff");l.x=50,l.y=25,n.addChild(l),this.cdTimer&&clearInterval(this.cdTimer),l.text=t+i.formatSecond(this.cdSec,"分","秒"),this.cdTimer=setInterval(function(){a.cdSec--,a.cdSec>0?l.text=t+i.formatSecond(a.cdSec,"分","秒"):a.fadeOutCountDown()},1e3),this.ctn.addChild(n),createjs.Tween.get(this.ctn).to({alpha:1},300)},e.prototype.fadeOut=function(){var e=this;clearInterval(this.cdTimer),createjs.Tween.get(this.ctn).to({alpha:0},300).call(function(){e.ctn.removeAllChildren()})},e.prototype.fadeOutCountDown=function(){this.fadeOut()},e}();t.CountDownPanel=o},function(e,t){"use strict";t.dynamicLoading={css:function(e){if(!e||0===e.length)throw new Error('argument "path" is required !');var t=document.getElementsByTagName("head")[0],a=document.createElement("link");a.href=e,a.rel="stylesheet",a.type="text/css",t.appendChild(a)},js:function(e){if(!e||0===e.length)throw new Error('argument "path" is required !');var t=document.getElementsByTagName("head")[0],a=document.createElement("script");a.src=e,a.type="text/javascript",t.appendChild(a)}},t.proxy=function(e){return"/proxy?url="+e}},function(e,t){e.exports='<div>\r\n    <div v-if="isOp" id="opPanel" style="position: absolute;left: 100px;top:60px;width: 1000px">\r\n        <h1>game id:{{gameId}}</h1>\r\n        <label class="label">设置延时时间(秒)</label>\r\n\r\n        <p class="control">\r\n            <input class="input" type="text"\r\n                   onkeypress=\'var c = event.charCode;\r\n                   return c >= 48 && c <= 57 ||c==46\'\r\n                   placeholder="" style="width: 50px;"\r\n                   v-model="delayTime">\r\n            <button class="button is-primary" @click="onClkSetDelay">确定</button>\r\n        </p>\r\n\r\n        <label class="label">现场时间:{{liveTime}}</label>\r\n        <label class="label">面板时间:{{panelTime}}</label>\r\n\r\n        <button class="button is-primary" @click="onClkStartTimer">开始</button>\r\n        <button class="button is-primary" @click="onClkPauseTimer">暂停</button>\r\n        <button class="button is-primary" @click="onClkResetTimer">重置</button>\r\n    </div>\r\n</div>\r\n'},function(e,t,a){"use strict";var n,r,i,o=this&&this.__extends||function(e,t){function a(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)},l=a(35),s=a(23),c=a(38),d=a(32),h=a(4),u=a(8),p=a(10),f=function(e){function t(){e.call(this),this.template=a(41),this.gameId=h.VueBase.String,this.isOp=h.VueBase.PROP,this.opReq=function(e,t,a){$.post("/panel/"+u.PanelId.onlinePanel+"/"+e,t,a)},this.methods={onClkHide:function(){console.log("onClkHide"),this.opReq(""+p.CommandId.cs_hideOnlinePanel,{_:null})},onClkRank:function(){console.log("onClkRank"),this.opReq(""+p.CommandId.cs_showRank,{_:null})},onClkBracket:function(){this.opReq(""+p.CommandId.cs_showBracket,{_:null})}},h.VueBase.initProps(this)}return o(t,e),t.prototype.created=function(){this.basePanelArr=[],this.isOp="op"==this.$route.params.op,this.isOp&&d.dynamicLoading.css("/css/bulma.min.css"),console.log("stageOnlineView created!")},t.prototype.mounted=function(){i=s.BasePanelView.initPixi(),this.gameId=this.$route.params.game_id,this.$route.query.panel&&"bracket"==this.$route.query.panel?this.showBracket():this.showRank(),console.log("StageOnlineView mounted!"),this.initIO()},t.prototype.initIO=function(){var e=this,t=io.connect("http://"+window.location.host+"/"+u.PanelId.rkbPanel);t.on("connect",function(e){console.log("connect",window.location.host),t.emit("opUrl",{opUrl:window.location.host})}).on(""+p.CommandId.sc_showRank,function(t){console.log("CommandId.sc_showRank",t),e.showRank()}).on(""+p.CommandId.sc_showBracket,function(t){console.log("CommandId.sc_showBracket",t),e.showBracket()}).on(""+p.CommandId.sc_hideOnlinePanel,function(t){e.showOnly("")})},t.prototype.showRank=function(){n||(n=new l.RankView(this,i),n.reqRank(this.gameId),this.basePanelArr.push(n)),n.reqRank(this.gameId),this.showOnly(n.name)},t.prototype.showBracket=function(){console.log("onClkBracket"),r||(r=new c.Bracket(i,this.gameId),this.basePanelArr.push(r)),this.showOnly(r.name)},t.prototype.showOnly=function(e){for(var t,a=0;a<this.basePanelArr.length;a++){var n=this.basePanelArr[a];e!=n.name?n.hide():t=n}t&&t.show()},t}(h.VueBase);t.stageOnlineView=new f},function(e,t,a){"use strict";var n=this&&this.__extends||function(e,t){function a(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)},r=a(16),i=a(23),o=a(8),l=a(36),s=a(37),c=a(13),d=function(e){function t(t,a){e.call(this,o.PanelId.onlinePanel),this.name=o.PanelId.rankPanel,this.$opView=t,this.ctn=new PIXI.Container,a.addChild(this.ctn),this.stage=a,console.log("new rankView")}return n(t,e),t.prototype.reqRank=function(e){var t=this,a=e;console.log("get /api/passerbyking/game/players/",a);var n="http://api.liangle.com/api/passerbyking/game/rank/"+a;$.get("http://"+window.location.host+"/get?url="+n,function(e){for(var n=JSON.parse(e.entity),i=n.data,o=[],s=0;s<i.player_rank.length;s++){var c=i.player_rank[s],d=new r.PlayerDoc;d.name=c.name,d.avatar=c.avatar,d.ftName=c.group,d.curFtScore=c.score,d.ftScore=c.total_score,o.push(d)}for(var h=[],u=0;u<i.group_rank.length;u++){var p=i.group_rank[u],f=new l.FTInfo;f.name=p.name,f.fullName=p.full_name,f.logo=p.logo,f.curScore=p.score,f.score=p.total_score,h.push(f)}t.fadeInMixRank({totalFtDocArr:h,totalPlayerDocArr:o,gameId:a,auto:!0})})},t.getPlayerItem=function(e,t,a){var n=new PIXI.Container,r=s.newBitmap({url:e.avatar,isCrossOrigin:!0,callback:function(){var e=r.width;r.y=18,r.scale.x=r.scale.y=119/r.height,r.x=18+(130-e*r.scale.x)/2}}),i=new PIXI.Graphics;if(i.beginFill(16711680),i.drawRect(0,0,130,130),i.x=i.y=18,n.addChild(i),r.mask=i,n.addChild(r),a){var l=s.newBitmap({url:"/img/panel/stage1v1/ft/rank"+a+".png"});l.x=-20,l.y=-30,n.addChild(l)}var c={fontFamily:o.FontName.MicrosoftYahei,fontSize:"40px",fontStyle:"normal",fontWeight:"bold",fill:"#F7EDCA",stroke:"#4a1850",strokeThickness:5,dropShadow:!1,dropShadowColor:"#000000",dropShadowAngle:Math.PI/6,dropShadowDistance:6,wordWrap:!0,wordWrapWidth:500},d=new PIXI.Text(e.name,c);d.x=160,d.y=30,n.addChild(d);var h;if(e.ftName)h=e.ftName;else{var u=t[e.ftId];h=u?u.name:"无"}c.fontSize="22px",c.dropShadow=!0,c.fontStyle="italic";var p=new PIXI.Text(h+" ",c);p.x=268,p.y=90,n.addChild(p);var f=new PIXI.Text(String(e.curFtScore?e.curFtScore:0),{align:"right",fill:"#ffffff"});f.style.font.fontsize(22),f.style.align="right",f.x=620,f.y=90,n.addChild(f),f.updateText();var g=new PIXI.Text(String(e.ftScore?e.ftScore:0),{align:"right",fill:"#ffffff"});return g.style.font.fontsize(22),g.style.align="right",g.x=770,g.y=90,n.addChild(g),n},t.prototype.hide=function(){this.ctn.visible=!1},t.prototype.show=function(){this.ctn.visible=!0},t.getFtItem=function(e,t){var a=new PIXI.Container,n=s.newBitmap({url:"/img/panel/stage1v1/ft/ftRankTeam.jpg"});a.addChild(n);var r=s.newBitmap({url:e.logo,isCrossOrigin:!0});if(r.x=18,r.y=18,a.addChild(r),t){var i=s.newBitmap({url:"/img/panel/stage1v1/ft/rank"+t+".png"});i.x=-20,i.y=-30,a.addChild(i)}var o={font:"bold 40px Arial",align:"right",fill:"#ffffff"},l=new PIXI.Text(e.name,o);l.x=160,l.y=40,a.addChild(l),o.font="bold 22px Arial";var c=new PIXI.Text(e.fullName+"",o);c.x=160,c.y=90,a.addChild(c);var d=new PIXI.Text((e.curScore?e.curScore:0)+"",o);d.textAlign="right",d.x=620,d.y=95,a.addChild(d);var h=new PIXI.Text((e.score?e.score:0)+"",o);return h.textAlign="right",h.x=780,h.y=95,a.addChild(h),a},t.prototype.fadeInMixRank=function(e){this.ctn.addChild(s.newBitmap({url:"/img/panel/stage1v1/ft/ftRankBg2.jpg"}));for(var a=0;a<5;a++){var n=t.getPlayerItem(e.totalPlayerDocArr[a],e.ftMap,0==a||1==a?a+1:null);n.x=45,n.y=140+185*a;var r=s.newBitmap({url:"/img/panel/stage1v1/ft/ftRankPlayer.jpg"});if(n.addChildAt(r,0),this.ctn.addChild(n),e.totalFtDocArr[a]){var i=t.getFtItem(e.totalFtDocArr[a],0==a||1==a?a+1:null);i.x=1005,i.y=n.y,this.ctn.addChild(i)}}var o=[];o.push({name:"itemBg",url:"/img/panel/stage1v1/ft/ftRankPlayer.jpg"}),c.loadImgArr(o,function(e){console.log("load img",e)})},t}(i.BasePanelView);t.RankView=d},function(e,t){"use strict";var a=function(){function e(){this.memberArr=[]}return e.saveScore=function(e,t){e.score?e.score+=t:e.score=t,e.curScore?e.curScore+=t:e.curScore=t},e.clone=function(t){var a=new e;return a._id=t._id,a.id=t.id,a.name=t.name,a.fullName=t.fullName,a.logo=t.logo,a.score=t.score,a.curScore=t.curScore,a},e}();t.FTInfo=a},function(e,t,a){"use strict";function n(e){return new PIXI.Texture(new PIXI.BaseTexture(e))}function r(e){var t=e.url,a=e.isCrossOrigin,r=e.callback,o=new PIXI.Sprite;return i(t,function(e){o.texture=n(e),r&&r(o)},a),o}function i(e,t,a){if(a){var n=new XMLHttpRequest;n.open("GET",c.proxy(e),!0),n.onload=function(e){s.loadImg(n.responseText,t)},n.send()}else s.loadImg(e,t)}function o(e){var t=e.width,a=e.height,r=e.url,o=e.callback,l=e.isCrossOrigin;i(r,function(e){s.texture=n(e),o&&o(s)},l);var s=new PIXI.extras.TilingSprite(d,t,a);return s}function l(e){var t,a=e.isTiling;return t=a?o(e):r(e),t.x=e.x?e.x:0,t.y=e.y?e.y:0,t}var s=a(13),c=a(32);t.imgToTex=n;var d=n(null);t.newBitmap=l},function(e,t,a){"use strict";var n=this&&this.__extends||function(e,t){function a(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)},r=a(23),i=a(8),o=a(39),l=a(37),s=a(40),c=a(25),d=function(e){function t(t,a){e.call(this,i.PanelId.onlinePanel),this.name=i.PanelId.bracketPanel,console.log("new bracket"),this.ctn=new PIXI.Container,t.addChild(this.ctn),this.stage=t,this.initAuto(a),this.initBg()}return n(t,e),t.prototype.initBg=function(){var e=this.ctn,t=l.newBitmap({url:"/img/panel/bracket/tile2.png",isTiling:!0,width:i.ViewConst.STAGE_WIDTH,height:i.ViewConst.STAGE_HEIGHT});t.alpha=.8,e.addChild(t),e.addChild(l.newBitmap({url:"/img/panel/bracket/title.png"}));var a={font:"25px",fill:"#C1C1C1",align:"right"},n={fontFamily:i.FontName.MicrosoftYahei,fontSize:"25px",fontStyle:"italic",fill:"#C1C1C1"};for(var r in o.groupPosMap){var c=o.groupPosMap[r],d=c.ctn=l.newBitmap({url:"/img/panel/bracket/group.png",x:c.x,y:c.y});e.addChild(d);var h=new PIXI.Graphics;h.beginFill(16711680).drawRoundedRect(0,0,45,45,5),h.x=160,h.y=3,h.visible=!1,c.winHint=h,d.addChild(h);var u=Number(r),p=new PIXI.Text(r,a);u>9?p.x=-50:p.x=-30,p.y=5,d.addChild(p);for(var f=0;f<c.hints.length;f++){var g=c.hints[f],m=new PIXI.Text(g,n);m.x=15,m.y=8+48*f,c.labels.push(m),d.addChild(m);var y=new PIXI.Graphics;y.y=m.y,y.x=m.x,y.beginFill(0).drawRect(0,0,135,50),d.addChild(y),m.mask=y,d.addChild(c.scores[f]),c.playerArr=[new o.PlayerSvg,new o.PlayerSvg]}}var v=213,w=48,x=o.groupPosMap[1];e.addChild(s.drawLine1(x.x+v,x.y+w)),x=o.groupPosMap[3],e.addChild(s.drawLine1(x.x+v,x.y+w)),x=o.groupPosMap[10],e.addChild(s.drawLine1(x.x+v,x.y+w-1)),x=o.groupPosMap[7],e.addChild(s.drawLine1(x.x+v,x.y+w,144)),x=o.groupPosMap[5],e.addChild(s.drawLine2(x.x+v,x.y-5)),x=o.groupPosMap[6],e.addChild(s.drawLine2(x.x+v,x.y-5)),x=o.groupPosMap[12],e.addChild(s.drawLine2(x.x+v,x.y-24,19)),x=o.groupPosMap[11],e.addChild(s.drawLine4(x.x+v,x.y+w-1)),this.comingTitle=l.newBitmap({url:"/img/panel/bracket/comingTitle.png"}),this.comingTitle.visible=!1,e.addChild(this.comingTitle)},t.prototype.showComingIdx=function(e){var t=o.groupPosMap[e];t&&(this.comingTitle.visible=!0,this.comingTitle.x=t.x-4,this.comingTitle.y=t.y-36,c.blink2(this.comingTitle,.6))},t.prototype.hideComing=function(){this.comingTitle.visible=!1},t.prototype.hide=function(){this.ctn.visible=!1},t.prototype.show=function(){this.ctn.visible=!0},t.prototype.initAuto=function(e){var t=this,a=io.connect(hupuWsUrl);a.on("connect",function(){console.log("hupuAuto socket connected GameId",e),a.emit("passerbyking",{game_id:e,page:"top8Map"})}),a.on("wall",function(e){var a=e.et,n={};console.log("event:",a,e),n.top8Match=function(){console.log("top8Match",e),e.data=e.list,t.onBracketData(e)},n.startGame=function(){t.hideComing()},n.updateScore=function(){t.hideComing()},n[a]&&n[a]()})},t.prototype.onBracketData=function(e){var t={},a={font:"25px",fill:"#e1e1e1",align:"right"};for(var n in e.data){var r=e.data[n],i=o.groupPosMap[n];i.idx=Number(n),(r.left.score||r.right.score)&&(r.left.score>r.right.score?i.playerArr[0].isWin=!0:i.playerArr[1].isWin=!0,t[n]=!0),r.left.name&&(i.labels[0].style=a),r.right.name&&(i.labels[1].style=a);var l=i.hints;i.labels[0].text=r.left.name||(l?l[0]:""),i.scores[0].text=r.left.score||"0",i.labels[1].text=r.right.name||(l?l[1]:""),i.scores[1].text=r.right.score||"0"}for(var s=0;s<14;s++){var c=t[14-s];if(c){this.showComingIdx(14-s+1);break}13==s&&this.showComingIdx(1)}for(var s=0;s<14;s++){var c=t[s+1];c?(o.groupPosMap[s+1].ctn.alpha=.3,o.groupPosMap[s+1].winHint.visible=!0,o.groupPosMap[s+1].playerArr[0].isWin?o.groupPosMap[s+1].winHint.y=3:o.groupPosMap[s+1].winHint.y=51):o.groupPosMap[s+1].winHint.visible=!1}},t}(r.BasePanelView);t.Bracket=d},function(e,t){"use strict";function a(e){var t=e.x,a=e.y,n=e.hints?e.hints:["",""],r={font:"25px",fill:"#C1C1C1",align:"right"},i=new PIXI.Text("",r);i.y=8;var o=new PIXI.Text("",r);return o.y=58,i.x=o.x=175,{x:t,y:a,labels:[],hints:n,scores:[i,o]}}t.groupPosMap={1:a({x:255,y:95,hints:["1号种子 ","8号种子 "]}),2:a({x:255,y:240,hints:["4号种子 ","5号种子 "]}),3:a({x:255,y:385,hints:["2号种子 ","7号种子 "]}),4:a({x:255,y:530,hints:["3号种子 ","6号种子 "]}),5:a({x:255,y:805,hints:["第1场败者 ","第2场败者 "]}),6:a({x:255,y:950,hints:["第3场败者 ","第4场败者 "]}),7:a({x:655,y:168}),8:a({x:655,y:457}),9:a({x:655,y:900,hints:["第7场败者 ",""]}),10:a({x:655,y:755,hints:["第8场败者 ",""]}),11:a({x:1055,y:312}),12:a({x:1055,y:825}),13:a({x:1460,y:755,hints:["第11场败者 ",""]}),14:a({x:1460,y:390,hints:["","第13场胜者 "]})};var n=function(){function e(e){this.idx=e,this.playerArr=[new r,new r]}return e}();t.BracketGroup=n;var r=function(){function e(){this.isHint=!1,this.isWin=!1,this.score=0}return e}();t.PlayerSvg=r},function(e,t){"use strict";function a(e,t,a){void 0===a&&(a=72);var n=new PIXI.Graphics;return n.x=e,n.y=t,n.lineColor=o,n.lineStyle(2,1579290).moveTo(0,1).lineTo(77,1).lineTo(77,a).lineTo(175,a).moveTo(175,a+i).lineTo(77,a+i).lineTo(77,a+i+a).lineTo(1,a+i+a).moveTo(1,a+a).lineTo(77-i,a+a).lineTo(77-i,1+i).lineTo(0,1+i)}function n(e,t,a){void 0===a&&(a=0);var n=new PIXI.Graphics;return n.x=e,n.y=t,n.lineWidth=2,n.lineStyle(2,o).moveTo(175,1).lineTo(77,1).lineTo(77,53+a).lineTo(0,53+a).moveTo(0,53+i+a).lineTo(77+i,53+i+a).lineTo(77+i,1+i).lineTo(175,1+i)}function r(e,t){var a=78,n=new PIXI.Graphics;return n.x=e,n.y=t,n.lineColor=o,n.lineStyle(2,1579290).moveTo(0,1).lineTo(77,1).lineTo(77,a).lineTo(175,a).moveTo(175,a+i).lineTo(77-i,a+i).lineTo(77-i,1+i).lineTo(0,1+i)}var i=5,o=1579290;t.drawLine1=a,t.drawLine2=n,t.drawLine4=r},function(e,t){e.exports='<div>\r\n    <div v-if="isOp" id="opPanel" style="position: absolute;left: 100px;top:60px;width: 1000px">\r\n        game id:{{gameId}}\r\n        <a class="button is-primary" @click="onClkRank">个人战团排行</a>\r\n        <a class="button is-primary" @click="onClkBracket">八强对阵</a>\r\n        <a class="button is-primary" @click="onClkHide">隐藏</a>\r\n    </div>\r\n</div>\r\n'}]);
//# sourceMappingURL=panel.js.map